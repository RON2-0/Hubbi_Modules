(function(i,x){typeof exports=="object"&&typeof module<"u"?module.exports=x(require("react/jsx-runtime"),require("react")):typeof define=="function"&&define.amd?define(["react/jsx-runtime","react"],x):(i=typeof globalThis<"u"?globalThis:i||self,i.com=i.com||{},i.com.hubbi=i.com.hubbi||{},i.com.hubbi.inventory=x(i.HubbiJSX,i.React))})(this,function(i,x){"use strict";function ft(e){const o=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const t in e)if(t!=="default"){const n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(o,t,n.get?n:{enumerable:!0,get:()=>e[t]})}}return o.default=e,Object.freeze(o)}const fe=ft(x),y=new Proxy({},{get:(e,o)=>{const t=window.hubbi;if(!t){console.warn("[Hubbi SDK] Accessing hubbi SDK before it is initialized");return}return t[o]}});var j={};/**
   * table-core
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function pe(){return{accessor:(e,o)=>typeof e=="function"?{...o,accessorFn:e}:{...o,accessorKey:e},display:e=>e,group:e=>e}}function U(e,o){return typeof e=="function"?e(o):e}function $(e,o){return t=>{o.setState(n=>({...n,[e]:U(t,n[e])}))}}function ie(e){return e instanceof Function}function pt(e){return Array.isArray(e)&&e.every(o=>typeof o=="number")}function ht(e,o){const t=[],n=r=>{r.forEach(s=>{t.push(s);const l=o(s);l!=null&&l.length&&n(l)})};return n(e),t}function S(e,o,t){let n=[],r;return s=>{let l;t.key&&t.debug&&(l=Date.now());const d=e(s);if(!(d.length!==n.length||d.some((g,m)=>n[m]!==g)))return r;n=d;let u;if(t.key&&t.debug&&(u=Date.now()),r=o(...d),t==null||t.onChange==null||t.onChange(r),t.key&&t.debug&&t!=null&&t.debug()){const g=Math.round((Date.now()-l)*100)/100,m=Math.round((Date.now()-u)*100)/100,f=m/16,a=(h,p)=>{for(h=String(h);h.length<p;)h=" "+h;return h};console.info(`%câ± ${a(m,5)} /${a(g,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*f,120))}deg 100% 31%);`,t==null?void 0:t.key)}return r}}function C(e,o,t,n){return{debug:()=>{var r;return(r=e==null?void 0:e.debugAll)!=null?r:e[o]},key:j.NODE_ENV==="development"&&t,onChange:n}}function mt(e,o,t,n){const r=()=>{var l;return(l=s.getValue())!=null?l:e.options.renderFallbackValue},s={id:`${o.id}_${t.id}`,row:o,column:t,getValue:()=>o.getValue(n),renderValue:r,getContext:S(()=>[e,t,o,s],(l,d,c,u)=>({table:l,column:d,row:c,cell:u,getValue:u.getValue,renderValue:u.renderValue}),C(e.options,"debugCells","cell.getContext"))};return e._features.forEach(l=>{l.createCell==null||l.createCell(s,t,o,e)},{}),s}function yt(e,o,t,n){var r,s;const d={...e._getDefaultColumnDef(),...o},c=d.accessorKey;let u=(r=(s=d.id)!=null?s:c?typeof String.prototype.replaceAll=="function"?c.replaceAll(".","_"):c.replace(/\./g,"_"):void 0)!=null?r:typeof d.header=="string"?d.header:void 0,g;if(d.accessorFn?g=d.accessorFn:c&&(c.includes(".")?g=f=>{let a=f;for(const p of c.split(".")){var h;a=(h=a)==null?void 0:h[p],j.NODE_ENV!=="production"&&a===void 0&&console.warn(`"${p}" in deeply nested key "${c}" returned undefined.`)}return a}:g=f=>f[d.accessorKey]),!u)throw j.NODE_ENV!=="production"?new Error(d.accessorFn?"Columns require an id when using an accessorFn":"Columns require an id when using a non-string header"):new Error;let m={id:`${String(u)}`,accessorFn:g,parent:n,depth:t,columnDef:d,columns:[],getFlatColumns:S(()=>[!0],()=>{var f;return[m,...(f=m.columns)==null?void 0:f.flatMap(a=>a.getFlatColumns())]},C(e.options,"debugColumns","column.getFlatColumns")),getLeafColumns:S(()=>[e._getOrderColumnsFn()],f=>{var a;if((a=m.columns)!=null&&a.length){let h=m.columns.flatMap(p=>p.getLeafColumns());return f(h)}return[m]},C(e.options,"debugColumns","column.getLeafColumns"))};for(const f of e._features)f.createColumn==null||f.createColumn(m,e);return m}const P="debugHeaders";function ze(e,o,t){var n;let s={id:(n=t.id)!=null?n:o.id,column:o,index:t.index,isPlaceholder:!!t.isPlaceholder,placeholderId:t.placeholderId,depth:t.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{const l=[],d=c=>{c.subHeaders&&c.subHeaders.length&&c.subHeaders.map(d),l.push(c)};return d(s),l},getContext:()=>({table:e,header:s,column:o})};return e._features.forEach(l=>{l.createHeader==null||l.createHeader(s,e)}),s}const vt={createTable:e=>{e.getHeaderGroups=S(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(o,t,n,r)=>{var s,l;const d=(s=n==null?void 0:n.map(m=>t.find(f=>f.id===m)).filter(Boolean))!=null?s:[],c=(l=r==null?void 0:r.map(m=>t.find(f=>f.id===m)).filter(Boolean))!=null?l:[],u=t.filter(m=>!(n!=null&&n.includes(m.id))&&!(r!=null&&r.includes(m.id)));return se(o,[...d,...u,...c],e)},C(e.options,P,"getHeaderGroups")),e.getCenterHeaderGroups=S(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(o,t,n,r)=>(t=t.filter(s=>!(n!=null&&n.includes(s.id))&&!(r!=null&&r.includes(s.id))),se(o,t,e,"center")),C(e.options,P,"getCenterHeaderGroups")),e.getLeftHeaderGroups=S(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left],(o,t,n)=>{var r;const s=(r=n==null?void 0:n.map(l=>t.find(d=>d.id===l)).filter(Boolean))!=null?r:[];return se(o,s,e,"left")},C(e.options,P,"getLeftHeaderGroups")),e.getRightHeaderGroups=S(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.right],(o,t,n)=>{var r;const s=(r=n==null?void 0:n.map(l=>t.find(d=>d.id===l)).filter(Boolean))!=null?r:[];return se(o,s,e,"right")},C(e.options,P,"getRightHeaderGroups")),e.getFooterGroups=S(()=>[e.getHeaderGroups()],o=>[...o].reverse(),C(e.options,P,"getFooterGroups")),e.getLeftFooterGroups=S(()=>[e.getLeftHeaderGroups()],o=>[...o].reverse(),C(e.options,P,"getLeftFooterGroups")),e.getCenterFooterGroups=S(()=>[e.getCenterHeaderGroups()],o=>[...o].reverse(),C(e.options,P,"getCenterFooterGroups")),e.getRightFooterGroups=S(()=>[e.getRightHeaderGroups()],o=>[...o].reverse(),C(e.options,P,"getRightFooterGroups")),e.getFlatHeaders=S(()=>[e.getHeaderGroups()],o=>o.map(t=>t.headers).flat(),C(e.options,P,"getFlatHeaders")),e.getLeftFlatHeaders=S(()=>[e.getLeftHeaderGroups()],o=>o.map(t=>t.headers).flat(),C(e.options,P,"getLeftFlatHeaders")),e.getCenterFlatHeaders=S(()=>[e.getCenterHeaderGroups()],o=>o.map(t=>t.headers).flat(),C(e.options,P,"getCenterFlatHeaders")),e.getRightFlatHeaders=S(()=>[e.getRightHeaderGroups()],o=>o.map(t=>t.headers).flat(),C(e.options,P,"getRightFlatHeaders")),e.getCenterLeafHeaders=S(()=>[e.getCenterFlatHeaders()],o=>o.filter(t=>{var n;return!((n=t.subHeaders)!=null&&n.length)}),C(e.options,P,"getCenterLeafHeaders")),e.getLeftLeafHeaders=S(()=>[e.getLeftFlatHeaders()],o=>o.filter(t=>{var n;return!((n=t.subHeaders)!=null&&n.length)}),C(e.options,P,"getLeftLeafHeaders")),e.getRightLeafHeaders=S(()=>[e.getRightFlatHeaders()],o=>o.filter(t=>{var n;return!((n=t.subHeaders)!=null&&n.length)}),C(e.options,P,"getRightLeafHeaders")),e.getLeafHeaders=S(()=>[e.getLeftHeaderGroups(),e.getCenterHeaderGroups(),e.getRightHeaderGroups()],(o,t,n)=>{var r,s,l,d,c,u;return[...(r=(s=o[0])==null?void 0:s.headers)!=null?r:[],...(l=(d=t[0])==null?void 0:d.headers)!=null?l:[],...(c=(u=n[0])==null?void 0:u.headers)!=null?c:[]].map(g=>g.getLeafHeaders()).flat()},C(e.options,P,"getLeafHeaders"))}};function se(e,o,t,n){var r,s;let l=0;const d=function(f,a){a===void 0&&(a=1),l=Math.max(l,a),f.filter(h=>h.getIsVisible()).forEach(h=>{var p;(p=h.columns)!=null&&p.length&&d(h.columns,a+1)},0)};d(e);let c=[];const u=(f,a)=>{const h={depth:a,id:[n,`${a}`].filter(Boolean).join("_"),headers:[]},p=[];f.forEach(v=>{const b=[...p].reverse()[0],w=v.column.depth===h.depth;let _,N=!1;if(w&&v.column.parent?_=v.column.parent:(_=v.column,N=!0),b&&(b==null?void 0:b.column)===_)b.subHeaders.push(v);else{const I=ze(t,_,{id:[n,a,_.id,v==null?void 0:v.id].filter(Boolean).join("_"),isPlaceholder:N,placeholderId:N?`${p.filter(F=>F.column===_).length}`:void 0,depth:a,index:p.length});I.subHeaders.push(v),p.push(I)}h.headers.push(v),v.headerGroup=h}),c.push(h),a>0&&u(p,a-1)},g=o.map((f,a)=>ze(t,f,{depth:l,index:a}));u(g,l-1),c.reverse();const m=f=>f.filter(h=>h.column.getIsVisible()).map(h=>{let p=0,v=0,b=[0];h.subHeaders&&h.subHeaders.length?(b=[],m(h.subHeaders).forEach(_=>{let{colSpan:N,rowSpan:I}=_;p+=N,b.push(I)})):p=1;const w=Math.min(...b);return v=v+w,h.colSpan=p,h.rowSpan=v,{colSpan:p,rowSpan:v}});return m((r=(s=c[0])==null?void 0:s.headers)!=null?r:[]),c}const he=(e,o,t,n,r,s,l)=>{let d={id:o,index:n,original:t,depth:r,parentId:l,_valuesCache:{},_uniqueValuesCache:{},getValue:c=>{if(d._valuesCache.hasOwnProperty(c))return d._valuesCache[c];const u=e.getColumn(c);if(u!=null&&u.accessorFn)return d._valuesCache[c]=u.accessorFn(d.original,n),d._valuesCache[c]},getUniqueValues:c=>{if(d._uniqueValuesCache.hasOwnProperty(c))return d._uniqueValuesCache[c];const u=e.getColumn(c);if(u!=null&&u.accessorFn)return u.columnDef.getUniqueValues?(d._uniqueValuesCache[c]=u.columnDef.getUniqueValues(d.original,n),d._uniqueValuesCache[c]):(d._uniqueValuesCache[c]=[d.getValue(c)],d._uniqueValuesCache[c])},renderValue:c=>{var u;return(u=d.getValue(c))!=null?u:e.options.renderFallbackValue},subRows:[],getLeafRows:()=>ht(d.subRows,c=>c.subRows),getParentRow:()=>d.parentId?e.getRow(d.parentId,!0):void 0,getParentRows:()=>{let c=[],u=d;for(;;){const g=u.getParentRow();if(!g)break;c.push(g),u=g}return c.reverse()},getAllCells:S(()=>[e.getAllLeafColumns()],c=>c.map(u=>mt(e,d,u,u.id)),C(e.options,"debugRows","getAllCells")),_getAllCellsByColumnId:S(()=>[d.getAllCells()],c=>c.reduce((u,g)=>(u[g.column.id]=g,u),{}),C(e.options,"debugRows","getAllCellsByColumnId"))};for(let c=0;c<e._features.length;c++){const u=e._features[c];u==null||u.createRow==null||u.createRow(d,e)}return d},bt={createColumn:(e,o)=>{e._getFacetedRowModel=o.options.getFacetedRowModel&&o.options.getFacetedRowModel(o,e.id),e.getFacetedRowModel=()=>e._getFacetedRowModel?e._getFacetedRowModel():o.getPreFilteredRowModel(),e._getFacetedUniqueValues=o.options.getFacetedUniqueValues&&o.options.getFacetedUniqueValues(o,e.id),e.getFacetedUniqueValues=()=>e._getFacetedUniqueValues?e._getFacetedUniqueValues():new Map,e._getFacetedMinMaxValues=o.options.getFacetedMinMaxValues&&o.options.getFacetedMinMaxValues(o,e.id),e.getFacetedMinMaxValues=()=>{if(e._getFacetedMinMaxValues)return e._getFacetedMinMaxValues()}}},Re=(e,o,t)=>{var n,r;const s=t==null||(n=t.toString())==null?void 0:n.toLowerCase();return!!(!((r=e.getValue(o))==null||(r=r.toString())==null||(r=r.toLowerCase())==null)&&r.includes(s))};Re.autoRemove=e=>L(e);const Ue=(e,o,t)=>{var n;return!!(!((n=e.getValue(o))==null||(n=n.toString())==null)&&n.includes(t))};Ue.autoRemove=e=>L(e);const Ge=(e,o,t)=>{var n;return((n=e.getValue(o))==null||(n=n.toString())==null?void 0:n.toLowerCase())===(t==null?void 0:t.toLowerCase())};Ge.autoRemove=e=>L(e);const je=(e,o,t)=>{var n;return(n=e.getValue(o))==null?void 0:n.includes(t)};je.autoRemove=e=>L(e);const Be=(e,o,t)=>!t.some(n=>{var r;return!((r=e.getValue(o))!=null&&r.includes(n))});Be.autoRemove=e=>L(e)||!(e!=null&&e.length);const We=(e,o,t)=>t.some(n=>{var r;return(r=e.getValue(o))==null?void 0:r.includes(n)});We.autoRemove=e=>L(e)||!(e!=null&&e.length);const Ke=(e,o,t)=>e.getValue(o)===t;Ke.autoRemove=e=>L(e);const Xe=(e,o,t)=>e.getValue(o)==t;Xe.autoRemove=e=>L(e);const me=(e,o,t)=>{let[n,r]=t;const s=e.getValue(o);return s>=n&&s<=r};me.resolveFilterValue=e=>{let[o,t]=e,n=typeof o!="number"?parseFloat(o):o,r=typeof t!="number"?parseFloat(t):t,s=o===null||Number.isNaN(n)?-1/0:n,l=t===null||Number.isNaN(r)?1/0:r;if(s>l){const d=s;s=l,l=d}return[s,l]},me.autoRemove=e=>L(e)||L(e[0])&&L(e[1]);const R={includesString:Re,includesStringSensitive:Ue,equalsString:Ge,arrIncludes:je,arrIncludesAll:Be,arrIncludesSome:We,equals:Ke,weakEquals:Xe,inNumberRange:me};function L(e){return e==null||e===""}const xt={getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:e=>({columnFilters:[],...e}),getDefaultOptions:e=>({onColumnFiltersChange:$("columnFilters",e),filterFromLeafRows:!1,maxLeafRowFilterDepth:100}),createColumn:(e,o)=>{e.getAutoFilterFn=()=>{const t=o.getCoreRowModel().flatRows[0],n=t==null?void 0:t.getValue(e.id);return typeof n=="string"?R.includesString:typeof n=="number"?R.inNumberRange:typeof n=="boolean"||n!==null&&typeof n=="object"?R.equals:Array.isArray(n)?R.arrIncludes:R.weakEquals},e.getFilterFn=()=>{var t,n;return ie(e.columnDef.filterFn)?e.columnDef.filterFn:e.columnDef.filterFn==="auto"?e.getAutoFilterFn():(t=(n=o.options.filterFns)==null?void 0:n[e.columnDef.filterFn])!=null?t:R[e.columnDef.filterFn]},e.getCanFilter=()=>{var t,n,r;return((t=e.columnDef.enableColumnFilter)!=null?t:!0)&&((n=o.options.enableColumnFilters)!=null?n:!0)&&((r=o.options.enableFilters)!=null?r:!0)&&!!e.accessorFn},e.getIsFiltered=()=>e.getFilterIndex()>-1,e.getFilterValue=()=>{var t;return(t=o.getState().columnFilters)==null||(t=t.find(n=>n.id===e.id))==null?void 0:t.value},e.getFilterIndex=()=>{var t,n;return(t=(n=o.getState().columnFilters)==null?void 0:n.findIndex(r=>r.id===e.id))!=null?t:-1},e.setFilterValue=t=>{o.setColumnFilters(n=>{const r=e.getFilterFn(),s=n==null?void 0:n.find(g=>g.id===e.id),l=U(t,s?s.value:void 0);if(Je(r,l,e)){var d;return(d=n==null?void 0:n.filter(g=>g.id!==e.id))!=null?d:[]}const c={id:e.id,value:l};if(s){var u;return(u=n==null?void 0:n.map(g=>g.id===e.id?c:g))!=null?u:[]}return n!=null&&n.length?[...n,c]:[c]})}},createRow:(e,o)=>{e.columnFilters={},e.columnFiltersMeta={}},createTable:e=>{e.setColumnFilters=o=>{const t=e.getAllLeafColumns(),n=r=>{var s;return(s=U(o,r))==null?void 0:s.filter(l=>{const d=t.find(c=>c.id===l.id);if(d){const c=d.getFilterFn();if(Je(c,l.value,d))return!1}return!0})};e.options.onColumnFiltersChange==null||e.options.onColumnFiltersChange(n)},e.resetColumnFilters=o=>{var t,n;e.setColumnFilters(o?[]:(t=(n=e.initialState)==null?void 0:n.columnFilters)!=null?t:[])},e.getPreFilteredRowModel=()=>e.getCoreRowModel(),e.getFilteredRowModel=()=>(!e._getFilteredRowModel&&e.options.getFilteredRowModel&&(e._getFilteredRowModel=e.options.getFilteredRowModel(e)),e.options.manualFiltering||!e._getFilteredRowModel?e.getPreFilteredRowModel():e._getFilteredRowModel())}};function Je(e,o,t){return(e&&e.autoRemove?e.autoRemove(o,t):!1)||typeof o>"u"||typeof o=="string"&&!o}const ye={sum:(e,o,t)=>t.reduce((n,r)=>{const s=r.getValue(e);return n+(typeof s=="number"?s:0)},0),min:(e,o,t)=>{let n;return t.forEach(r=>{const s=r.getValue(e);s!=null&&(n>s||n===void 0&&s>=s)&&(n=s)}),n},max:(e,o,t)=>{let n;return t.forEach(r=>{const s=r.getValue(e);s!=null&&(n<s||n===void 0&&s>=s)&&(n=s)}),n},extent:(e,o,t)=>{let n,r;return t.forEach(s=>{const l=s.getValue(e);l!=null&&(n===void 0?l>=l&&(n=r=l):(n>l&&(n=l),r<l&&(r=l)))}),[n,r]},mean:(e,o)=>{let t=0,n=0;if(o.forEach(r=>{let s=r.getValue(e);s!=null&&(s=+s)>=s&&(++t,n+=s)}),t)return n/t},median:(e,o)=>{if(!o.length)return;const t=o.map(s=>s.getValue(e));if(!pt(t))return;if(t.length===1)return t[0];const n=Math.floor(t.length/2),r=t.sort((s,l)=>s-l);return t.length%2!==0?r[n]:(r[n-1]+r[n])/2},unique:(e,o)=>Array.from(new Set(o.map(t=>t.getValue(e))).values()),uniqueCount:(e,o)=>new Set(o.map(t=>t.getValue(e))).size,count:(e,o)=>o.length},_t={getDefaultColumnDef:()=>({aggregatedCell:e=>{var o,t;return(o=(t=e.getValue())==null||t.toString==null?void 0:t.toString())!=null?o:null},aggregationFn:"auto"}),getInitialState:e=>({grouping:[],...e}),getDefaultOptions:e=>({onGroupingChange:$("grouping",e),groupedColumnMode:"reorder"}),createColumn:(e,o)=>{e.toggleGrouping=()=>{o.setGrouping(t=>t!=null&&t.includes(e.id)?t.filter(n=>n!==e.id):[...t??[],e.id])},e.getCanGroup=()=>{var t,n;return((t=e.columnDef.enableGrouping)!=null?t:!0)&&((n=o.options.enableGrouping)!=null?n:!0)&&(!!e.accessorFn||!!e.columnDef.getGroupingValue)},e.getIsGrouped=()=>{var t;return(t=o.getState().grouping)==null?void 0:t.includes(e.id)},e.getGroupedIndex=()=>{var t;return(t=o.getState().grouping)==null?void 0:t.indexOf(e.id)},e.getToggleGroupingHandler=()=>{const t=e.getCanGroup();return()=>{t&&e.toggleGrouping()}},e.getAutoAggregationFn=()=>{const t=o.getCoreRowModel().flatRows[0],n=t==null?void 0:t.getValue(e.id);if(typeof n=="number")return ye.sum;if(Object.prototype.toString.call(n)==="[object Date]")return ye.extent},e.getAggregationFn=()=>{var t,n;if(!e)throw new Error;return ie(e.columnDef.aggregationFn)?e.columnDef.aggregationFn:e.columnDef.aggregationFn==="auto"?e.getAutoAggregationFn():(t=(n=o.options.aggregationFns)==null?void 0:n[e.columnDef.aggregationFn])!=null?t:ye[e.columnDef.aggregationFn]}},createTable:e=>{e.setGrouping=o=>e.options.onGroupingChange==null?void 0:e.options.onGroupingChange(o),e.resetGrouping=o=>{var t,n;e.setGrouping(o?[]:(t=(n=e.initialState)==null?void 0:n.grouping)!=null?t:[])},e.getPreGroupedRowModel=()=>e.getFilteredRowModel(),e.getGroupedRowModel=()=>(!e._getGroupedRowModel&&e.options.getGroupedRowModel&&(e._getGroupedRowModel=e.options.getGroupedRowModel(e)),e.options.manualGrouping||!e._getGroupedRowModel?e.getPreGroupedRowModel():e._getGroupedRowModel())},createRow:(e,o)=>{e.getIsGrouped=()=>!!e.groupingColumnId,e.getGroupingValue=t=>{if(e._groupingValuesCache.hasOwnProperty(t))return e._groupingValuesCache[t];const n=o.getColumn(t);return n!=null&&n.columnDef.getGroupingValue?(e._groupingValuesCache[t]=n.columnDef.getGroupingValue(e.original),e._groupingValuesCache[t]):e.getValue(t)},e._groupingValuesCache={}},createCell:(e,o,t,n)=>{e.getIsGrouped=()=>o.getIsGrouped()&&o.id===t.groupingColumnId,e.getIsPlaceholder=()=>!e.getIsGrouped()&&o.getIsGrouped(),e.getIsAggregated=()=>{var r;return!e.getIsGrouped()&&!e.getIsPlaceholder()&&!!((r=t.subRows)!=null&&r.length)}}};function wt(e,o,t){if(!(o!=null&&o.length)||!t)return e;const n=e.filter(s=>!o.includes(s.id));return t==="remove"?n:[...o.map(s=>e.find(l=>l.id===s)).filter(Boolean),...n]}const St={getInitialState:e=>({columnOrder:[],...e}),getDefaultOptions:e=>({onColumnOrderChange:$("columnOrder",e)}),createColumn:(e,o)=>{e.getIndex=S(t=>[Q(o,t)],t=>t.findIndex(n=>n.id===e.id),C(o.options,"debugColumns","getIndex")),e.getIsFirstColumn=t=>{var n;return((n=Q(o,t)[0])==null?void 0:n.id)===e.id},e.getIsLastColumn=t=>{var n;const r=Q(o,t);return((n=r[r.length-1])==null?void 0:n.id)===e.id}},createTable:e=>{e.setColumnOrder=o=>e.options.onColumnOrderChange==null?void 0:e.options.onColumnOrderChange(o),e.resetColumnOrder=o=>{var t;e.setColumnOrder(o?[]:(t=e.initialState.columnOrder)!=null?t:[])},e._getOrderColumnsFn=S(()=>[e.getState().columnOrder,e.getState().grouping,e.options.groupedColumnMode],(o,t,n)=>r=>{let s=[];if(!(o!=null&&o.length))s=r;else{const l=[...o],d=[...r];for(;d.length&&l.length;){const c=l.shift(),u=d.findIndex(g=>g.id===c);u>-1&&s.push(d.splice(u,1)[0])}s=[...s,...d]}return wt(s,t,n)},C(e.options,"debugTable","_getOrderColumnsFn"))}},ve=()=>({left:[],right:[]}),Ct={getInitialState:e=>({columnPinning:ve(),...e}),getDefaultOptions:e=>({onColumnPinningChange:$("columnPinning",e)}),createColumn:(e,o)=>{e.pin=t=>{const n=e.getLeafColumns().map(r=>r.id).filter(Boolean);o.setColumnPinning(r=>{var s,l;if(t==="right"){var d,c;return{left:((d=r==null?void 0:r.left)!=null?d:[]).filter(m=>!(n!=null&&n.includes(m))),right:[...((c=r==null?void 0:r.right)!=null?c:[]).filter(m=>!(n!=null&&n.includes(m))),...n]}}if(t==="left"){var u,g;return{left:[...((u=r==null?void 0:r.left)!=null?u:[]).filter(m=>!(n!=null&&n.includes(m))),...n],right:((g=r==null?void 0:r.right)!=null?g:[]).filter(m=>!(n!=null&&n.includes(m)))}}return{left:((s=r==null?void 0:r.left)!=null?s:[]).filter(m=>!(n!=null&&n.includes(m))),right:((l=r==null?void 0:r.right)!=null?l:[]).filter(m=>!(n!=null&&n.includes(m)))}})},e.getCanPin=()=>e.getLeafColumns().some(n=>{var r,s,l;return((r=n.columnDef.enablePinning)!=null?r:!0)&&((s=(l=o.options.enableColumnPinning)!=null?l:o.options.enablePinning)!=null?s:!0)}),e.getIsPinned=()=>{const t=e.getLeafColumns().map(d=>d.id),{left:n,right:r}=o.getState().columnPinning,s=t.some(d=>n==null?void 0:n.includes(d)),l=t.some(d=>r==null?void 0:r.includes(d));return s?"left":l?"right":!1},e.getPinnedIndex=()=>{var t,n;const r=e.getIsPinned();return r?(t=(n=o.getState().columnPinning)==null||(n=n[r])==null?void 0:n.indexOf(e.id))!=null?t:-1:0}},createRow:(e,o)=>{e.getCenterVisibleCells=S(()=>[e._getAllVisibleCells(),o.getState().columnPinning.left,o.getState().columnPinning.right],(t,n,r)=>{const s=[...n??[],...r??[]];return t.filter(l=>!s.includes(l.column.id))},C(o.options,"debugRows","getCenterVisibleCells")),e.getLeftVisibleCells=S(()=>[e._getAllVisibleCells(),o.getState().columnPinning.left],(t,n)=>(n??[]).map(s=>t.find(l=>l.column.id===s)).filter(Boolean).map(s=>({...s,position:"left"})),C(o.options,"debugRows","getLeftVisibleCells")),e.getRightVisibleCells=S(()=>[e._getAllVisibleCells(),o.getState().columnPinning.right],(t,n)=>(n??[]).map(s=>t.find(l=>l.column.id===s)).filter(Boolean).map(s=>({...s,position:"right"})),C(o.options,"debugRows","getRightVisibleCells"))},createTable:e=>{e.setColumnPinning=o=>e.options.onColumnPinningChange==null?void 0:e.options.onColumnPinningChange(o),e.resetColumnPinning=o=>{var t,n;return e.setColumnPinning(o?ve():(t=(n=e.initialState)==null?void 0:n.columnPinning)!=null?t:ve())},e.getIsSomeColumnsPinned=o=>{var t;const n=e.getState().columnPinning;if(!o){var r,s;return!!((r=n.left)!=null&&r.length||(s=n.right)!=null&&s.length)}return!!((t=n[o])!=null&&t.length)},e.getLeftLeafColumns=S(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left],(o,t)=>(t??[]).map(n=>o.find(r=>r.id===n)).filter(Boolean),C(e.options,"debugColumns","getLeftLeafColumns")),e.getRightLeafColumns=S(()=>[e.getAllLeafColumns(),e.getState().columnPinning.right],(o,t)=>(t??[]).map(n=>o.find(r=>r.id===n)).filter(Boolean),C(e.options,"debugColumns","getRightLeafColumns")),e.getCenterLeafColumns=S(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(o,t,n)=>{const r=[...t??[],...n??[]];return o.filter(s=>!r.includes(s.id))},C(e.options,"debugColumns","getCenterLeafColumns"))}};function It(e){return e||(typeof document<"u"?document:null)}const le={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},be=()=>({startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}),Et={getDefaultColumnDef:()=>le,getInitialState:e=>({columnSizing:{},columnSizingInfo:be(),...e}),getDefaultOptions:e=>({columnResizeMode:"onEnd",columnResizeDirection:"ltr",onColumnSizingChange:$("columnSizing",e),onColumnSizingInfoChange:$("columnSizingInfo",e)}),createColumn:(e,o)=>{e.getSize=()=>{var t,n,r;const s=o.getState().columnSizing[e.id];return Math.min(Math.max((t=e.columnDef.minSize)!=null?t:le.minSize,(n=s??e.columnDef.size)!=null?n:le.size),(r=e.columnDef.maxSize)!=null?r:le.maxSize)},e.getStart=S(t=>[t,Q(o,t),o.getState().columnSizing],(t,n)=>n.slice(0,e.getIndex(t)).reduce((r,s)=>r+s.getSize(),0),C(o.options,"debugColumns","getStart")),e.getAfter=S(t=>[t,Q(o,t),o.getState().columnSizing],(t,n)=>n.slice(e.getIndex(t)+1).reduce((r,s)=>r+s.getSize(),0),C(o.options,"debugColumns","getAfter")),e.resetSize=()=>{o.setColumnSizing(t=>{let{[e.id]:n,...r}=t;return r})},e.getCanResize=()=>{var t,n;return((t=e.columnDef.enableResizing)!=null?t:!0)&&((n=o.options.enableColumnResizing)!=null?n:!0)},e.getIsResizing=()=>o.getState().columnSizingInfo.isResizingColumn===e.id},createHeader:(e,o)=>{e.getSize=()=>{let t=0;const n=r=>{if(r.subHeaders.length)r.subHeaders.forEach(n);else{var s;t+=(s=r.column.getSize())!=null?s:0}};return n(e),t},e.getStart=()=>{if(e.index>0){const t=e.headerGroup.headers[e.index-1];return t.getStart()+t.getSize()}return 0},e.getResizeHandler=t=>{const n=o.getColumn(e.column.id),r=n==null?void 0:n.getCanResize();return s=>{if(!n||!r||(s.persist==null||s.persist(),xe(s)&&s.touches&&s.touches.length>1))return;const l=e.getSize(),d=e?e.getLeafHeaders().map(b=>[b.column.id,b.column.getSize()]):[[n.id,n.getSize()]],c=xe(s)?Math.round(s.touches[0].clientX):s.clientX,u={},g=(b,w)=>{typeof w=="number"&&(o.setColumnSizingInfo(_=>{var N,I;const F=o.options.columnResizeDirection==="rtl"?-1:1,V=(w-((N=_==null?void 0:_.startOffset)!=null?N:0))*F,H=Math.max(V/((I=_==null?void 0:_.startSize)!=null?I:0),-.999999);return _.columnSizingStart.forEach(k=>{let[T,q]=k;u[T]=Math.round(Math.max(q+q*H,0)*100)/100}),{..._,deltaOffset:V,deltaPercentage:H}}),(o.options.columnResizeMode==="onChange"||b==="end")&&o.setColumnSizing(_=>({..._,...u})))},m=b=>g("move",b),f=b=>{g("end",b),o.setColumnSizingInfo(w=>({...w,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))},a=It(t),h={moveHandler:b=>m(b.clientX),upHandler:b=>{a==null||a.removeEventListener("mousemove",h.moveHandler),a==null||a.removeEventListener("mouseup",h.upHandler),f(b.clientX)}},p={moveHandler:b=>(b.cancelable&&(b.preventDefault(),b.stopPropagation()),m(b.touches[0].clientX),!1),upHandler:b=>{var w;a==null||a.removeEventListener("touchmove",p.moveHandler),a==null||a.removeEventListener("touchend",p.upHandler),b.cancelable&&(b.preventDefault(),b.stopPropagation()),f((w=b.touches[0])==null?void 0:w.clientX)}},v=Nt()?{passive:!1}:!1;xe(s)?(a==null||a.addEventListener("touchmove",p.moveHandler,v),a==null||a.addEventListener("touchend",p.upHandler,v)):(a==null||a.addEventListener("mousemove",h.moveHandler,v),a==null||a.addEventListener("mouseup",h.upHandler,v)),o.setColumnSizingInfo(b=>({...b,startOffset:c,startSize:l,deltaOffset:0,deltaPercentage:0,columnSizingStart:d,isResizingColumn:n.id}))}}},createTable:e=>{e.setColumnSizing=o=>e.options.onColumnSizingChange==null?void 0:e.options.onColumnSizingChange(o),e.setColumnSizingInfo=o=>e.options.onColumnSizingInfoChange==null?void 0:e.options.onColumnSizingInfoChange(o),e.resetColumnSizing=o=>{var t;e.setColumnSizing(o?{}:(t=e.initialState.columnSizing)!=null?t:{})},e.resetHeaderSizeInfo=o=>{var t;e.setColumnSizingInfo(o?be():(t=e.initialState.columnSizingInfo)!=null?t:be())},e.getTotalSize=()=>{var o,t;return(o=(t=e.getHeaderGroups()[0])==null?void 0:t.headers.reduce((n,r)=>n+r.getSize(),0))!=null?o:0},e.getLeftTotalSize=()=>{var o,t;return(o=(t=e.getLeftHeaderGroups()[0])==null?void 0:t.headers.reduce((n,r)=>n+r.getSize(),0))!=null?o:0},e.getCenterTotalSize=()=>{var o,t;return(o=(t=e.getCenterHeaderGroups()[0])==null?void 0:t.headers.reduce((n,r)=>n+r.getSize(),0))!=null?o:0},e.getRightTotalSize=()=>{var o,t;return(o=(t=e.getRightHeaderGroups()[0])==null?void 0:t.headers.reduce((n,r)=>n+r.getSize(),0))!=null?o:0}}};let ae=null;function Nt(){if(typeof ae=="boolean")return ae;let e=!1;try{const o={get passive(){return e=!0,!1}},t=()=>{};window.addEventListener("test",t,o),window.removeEventListener("test",t)}catch{e=!1}return ae=e,ae}function xe(e){return e.type==="touchstart"}const kt={getInitialState:e=>({columnVisibility:{},...e}),getDefaultOptions:e=>({onColumnVisibilityChange:$("columnVisibility",e)}),createColumn:(e,o)=>{e.toggleVisibility=t=>{e.getCanHide()&&o.setColumnVisibility(n=>({...n,[e.id]:t??!e.getIsVisible()}))},e.getIsVisible=()=>{var t,n;const r=e.columns;return(t=r.length?r.some(s=>s.getIsVisible()):(n=o.getState().columnVisibility)==null?void 0:n[e.id])!=null?t:!0},e.getCanHide=()=>{var t,n;return((t=e.columnDef.enableHiding)!=null?t:!0)&&((n=o.options.enableHiding)!=null?n:!0)},e.getToggleVisibilityHandler=()=>t=>{e.toggleVisibility==null||e.toggleVisibility(t.target.checked)}},createRow:(e,o)=>{e._getAllVisibleCells=S(()=>[e.getAllCells(),o.getState().columnVisibility],t=>t.filter(n=>n.column.getIsVisible()),C(o.options,"debugRows","_getAllVisibleCells")),e.getVisibleCells=S(()=>[e.getLeftVisibleCells(),e.getCenterVisibleCells(),e.getRightVisibleCells()],(t,n,r)=>[...t,...n,...r],C(o.options,"debugRows","getVisibleCells"))},createTable:e=>{const o=(t,n)=>S(()=>[n(),n().filter(r=>r.getIsVisible()).map(r=>r.id).join("_")],r=>r.filter(s=>s.getIsVisible==null?void 0:s.getIsVisible()),C(e.options,"debugColumns",t));e.getVisibleFlatColumns=o("getVisibleFlatColumns",()=>e.getAllFlatColumns()),e.getVisibleLeafColumns=o("getVisibleLeafColumns",()=>e.getAllLeafColumns()),e.getLeftVisibleLeafColumns=o("getLeftVisibleLeafColumns",()=>e.getLeftLeafColumns()),e.getRightVisibleLeafColumns=o("getRightVisibleLeafColumns",()=>e.getRightLeafColumns()),e.getCenterVisibleLeafColumns=o("getCenterVisibleLeafColumns",()=>e.getCenterLeafColumns()),e.setColumnVisibility=t=>e.options.onColumnVisibilityChange==null?void 0:e.options.onColumnVisibilityChange(t),e.resetColumnVisibility=t=>{var n;e.setColumnVisibility(t?{}:(n=e.initialState.columnVisibility)!=null?n:{})},e.toggleAllColumnsVisible=t=>{var n;t=(n=t)!=null?n:!e.getIsAllColumnsVisible(),e.setColumnVisibility(e.getAllLeafColumns().reduce((r,s)=>({...r,[s.id]:t||!(s.getCanHide!=null&&s.getCanHide())}),{}))},e.getIsAllColumnsVisible=()=>!e.getAllLeafColumns().some(t=>!(t.getIsVisible!=null&&t.getIsVisible())),e.getIsSomeColumnsVisible=()=>e.getAllLeafColumns().some(t=>t.getIsVisible==null?void 0:t.getIsVisible()),e.getToggleAllColumnsVisibilityHandler=()=>t=>{var n;e.toggleAllColumnsVisible((n=t.target)==null?void 0:n.checked)}}};function Q(e,o){return o?o==="center"?e.getCenterVisibleLeafColumns():o==="left"?e.getLeftVisibleLeafColumns():e.getRightVisibleLeafColumns():e.getVisibleLeafColumns()}const Ft={createTable:e=>{e._getGlobalFacetedRowModel=e.options.getFacetedRowModel&&e.options.getFacetedRowModel(e,"__global__"),e.getGlobalFacetedRowModel=()=>e.options.manualFiltering||!e._getGlobalFacetedRowModel?e.getPreFilteredRowModel():e._getGlobalFacetedRowModel(),e._getGlobalFacetedUniqueValues=e.options.getFacetedUniqueValues&&e.options.getFacetedUniqueValues(e,"__global__"),e.getGlobalFacetedUniqueValues=()=>e._getGlobalFacetedUniqueValues?e._getGlobalFacetedUniqueValues():new Map,e._getGlobalFacetedMinMaxValues=e.options.getFacetedMinMaxValues&&e.options.getFacetedMinMaxValues(e,"__global__"),e.getGlobalFacetedMinMaxValues=()=>{if(e._getGlobalFacetedMinMaxValues)return e._getGlobalFacetedMinMaxValues()}}},Mt={getInitialState:e=>({globalFilter:void 0,...e}),getDefaultOptions:e=>({onGlobalFilterChange:$("globalFilter",e),globalFilterFn:"auto",getColumnCanGlobalFilter:o=>{var t;const n=(t=e.getCoreRowModel().flatRows[0])==null||(t=t._getAllCellsByColumnId()[o.id])==null?void 0:t.getValue();return typeof n=="string"||typeof n=="number"}}),createColumn:(e,o)=>{e.getCanGlobalFilter=()=>{var t,n,r,s;return((t=e.columnDef.enableGlobalFilter)!=null?t:!0)&&((n=o.options.enableGlobalFilter)!=null?n:!0)&&((r=o.options.enableFilters)!=null?r:!0)&&((s=o.options.getColumnCanGlobalFilter==null?void 0:o.options.getColumnCanGlobalFilter(e))!=null?s:!0)&&!!e.accessorFn}},createTable:e=>{e.getGlobalAutoFilterFn=()=>R.includesString,e.getGlobalFilterFn=()=>{var o,t;const{globalFilterFn:n}=e.options;return ie(n)?n:n==="auto"?e.getGlobalAutoFilterFn():(o=(t=e.options.filterFns)==null?void 0:t[n])!=null?o:R[n]},e.setGlobalFilter=o=>{e.options.onGlobalFilterChange==null||e.options.onGlobalFilterChange(o)},e.resetGlobalFilter=o=>{e.setGlobalFilter(o?void 0:e.initialState.globalFilter)}}},At={getInitialState:e=>({expanded:{},...e}),getDefaultOptions:e=>({onExpandedChange:$("expanded",e),paginateExpandedRows:!0}),createTable:e=>{let o=!1,t=!1;e._autoResetExpanded=()=>{var n,r;if(!o){e._queue(()=>{o=!0});return}if((n=(r=e.options.autoResetAll)!=null?r:e.options.autoResetExpanded)!=null?n:!e.options.manualExpanding){if(t)return;t=!0,e._queue(()=>{e.resetExpanded(),t=!1})}},e.setExpanded=n=>e.options.onExpandedChange==null?void 0:e.options.onExpandedChange(n),e.toggleAllRowsExpanded=n=>{n??!e.getIsAllRowsExpanded()?e.setExpanded(!0):e.setExpanded({})},e.resetExpanded=n=>{var r,s;e.setExpanded(n?{}:(r=(s=e.initialState)==null?void 0:s.expanded)!=null?r:{})},e.getCanSomeRowsExpand=()=>e.getPrePaginationRowModel().flatRows.some(n=>n.getCanExpand()),e.getToggleAllRowsExpandedHandler=()=>n=>{n.persist==null||n.persist(),e.toggleAllRowsExpanded()},e.getIsSomeRowsExpanded=()=>{const n=e.getState().expanded;return n===!0||Object.values(n).some(Boolean)},e.getIsAllRowsExpanded=()=>{const n=e.getState().expanded;return typeof n=="boolean"?n===!0:!(!Object.keys(n).length||e.getRowModel().flatRows.some(r=>!r.getIsExpanded()))},e.getExpandedDepth=()=>{let n=0;return(e.getState().expanded===!0?Object.keys(e.getRowModel().rowsById):Object.keys(e.getState().expanded)).forEach(s=>{const l=s.split(".");n=Math.max(n,l.length)}),n},e.getPreExpandedRowModel=()=>e.getSortedRowModel(),e.getExpandedRowModel=()=>(!e._getExpandedRowModel&&e.options.getExpandedRowModel&&(e._getExpandedRowModel=e.options.getExpandedRowModel(e)),e.options.manualExpanding||!e._getExpandedRowModel?e.getPreExpandedRowModel():e._getExpandedRowModel())},createRow:(e,o)=>{e.toggleExpanded=t=>{o.setExpanded(n=>{var r;const s=n===!0?!0:!!(n!=null&&n[e.id]);let l={};if(n===!0?Object.keys(o.getRowModel().rowsById).forEach(d=>{l[d]=!0}):l=n,t=(r=t)!=null?r:!s,!s&&t)return{...l,[e.id]:!0};if(s&&!t){const{[e.id]:d,...c}=l;return c}return n})},e.getIsExpanded=()=>{var t;const n=o.getState().expanded;return!!((t=o.options.getIsRowExpanded==null?void 0:o.options.getIsRowExpanded(e))!=null?t:n===!0||n!=null&&n[e.id])},e.getCanExpand=()=>{var t,n,r;return(t=o.options.getRowCanExpand==null?void 0:o.options.getRowCanExpand(e))!=null?t:((n=o.options.enableExpanding)!=null?n:!0)&&!!((r=e.subRows)!=null&&r.length)},e.getIsAllParentsExpanded=()=>{let t=!0,n=e;for(;t&&n.parentId;)n=o.getRow(n.parentId,!0),t=n.getIsExpanded();return t},e.getToggleExpandedHandler=()=>{const t=e.getCanExpand();return()=>{t&&e.toggleExpanded()}}}},_e=0,we=10,Se=()=>({pageIndex:_e,pageSize:we}),Dt={getInitialState:e=>({...e,pagination:{...Se(),...e==null?void 0:e.pagination}}),getDefaultOptions:e=>({onPaginationChange:$("pagination",e)}),createTable:e=>{let o=!1,t=!1;e._autoResetPageIndex=()=>{var n,r;if(!o){e._queue(()=>{o=!0});return}if((n=(r=e.options.autoResetAll)!=null?r:e.options.autoResetPageIndex)!=null?n:!e.options.manualPagination){if(t)return;t=!0,e._queue(()=>{e.resetPageIndex(),t=!1})}},e.setPagination=n=>{const r=s=>U(n,s);return e.options.onPaginationChange==null?void 0:e.options.onPaginationChange(r)},e.resetPagination=n=>{var r;e.setPagination(n?Se():(r=e.initialState.pagination)!=null?r:Se())},e.setPageIndex=n=>{e.setPagination(r=>{let s=U(n,r.pageIndex);const l=typeof e.options.pageCount>"u"||e.options.pageCount===-1?Number.MAX_SAFE_INTEGER:e.options.pageCount-1;return s=Math.max(0,Math.min(s,l)),{...r,pageIndex:s}})},e.resetPageIndex=n=>{var r,s;e.setPageIndex(n?_e:(r=(s=e.initialState)==null||(s=s.pagination)==null?void 0:s.pageIndex)!=null?r:_e)},e.resetPageSize=n=>{var r,s;e.setPageSize(n?we:(r=(s=e.initialState)==null||(s=s.pagination)==null?void 0:s.pageSize)!=null?r:we)},e.setPageSize=n=>{e.setPagination(r=>{const s=Math.max(1,U(n,r.pageSize)),l=r.pageSize*r.pageIndex,d=Math.floor(l/s);return{...r,pageIndex:d,pageSize:s}})},e.setPageCount=n=>e.setPagination(r=>{var s;let l=U(n,(s=e.options.pageCount)!=null?s:-1);return typeof l=="number"&&(l=Math.max(-1,l)),{...r,pageCount:l}}),e.getPageOptions=S(()=>[e.getPageCount()],n=>{let r=[];return n&&n>0&&(r=[...new Array(n)].fill(null).map((s,l)=>l)),r},C(e.options,"debugTable","getPageOptions")),e.getCanPreviousPage=()=>e.getState().pagination.pageIndex>0,e.getCanNextPage=()=>{const{pageIndex:n}=e.getState().pagination,r=e.getPageCount();return r===-1?!0:r===0?!1:n<r-1},e.previousPage=()=>e.setPageIndex(n=>n-1),e.nextPage=()=>e.setPageIndex(n=>n+1),e.firstPage=()=>e.setPageIndex(0),e.lastPage=()=>e.setPageIndex(e.getPageCount()-1),e.getPrePaginationRowModel=()=>e.getExpandedRowModel(),e.getPaginationRowModel=()=>(!e._getPaginationRowModel&&e.options.getPaginationRowModel&&(e._getPaginationRowModel=e.options.getPaginationRowModel(e)),e.options.manualPagination||!e._getPaginationRowModel?e.getPrePaginationRowModel():e._getPaginationRowModel()),e.getPageCount=()=>{var n;return(n=e.options.pageCount)!=null?n:Math.ceil(e.getRowCount()/e.getState().pagination.pageSize)},e.getRowCount=()=>{var n;return(n=e.options.rowCount)!=null?n:e.getPrePaginationRowModel().rows.length}}},Ce=()=>({top:[],bottom:[]}),Pt={getInitialState:e=>({rowPinning:Ce(),...e}),getDefaultOptions:e=>({onRowPinningChange:$("rowPinning",e)}),createRow:(e,o)=>{e.pin=(t,n,r)=>{const s=n?e.getLeafRows().map(c=>{let{id:u}=c;return u}):[],l=r?e.getParentRows().map(c=>{let{id:u}=c;return u}):[],d=new Set([...l,e.id,...s]);o.setRowPinning(c=>{var u,g;if(t==="bottom"){var m,f;return{top:((m=c==null?void 0:c.top)!=null?m:[]).filter(p=>!(d!=null&&d.has(p))),bottom:[...((f=c==null?void 0:c.bottom)!=null?f:[]).filter(p=>!(d!=null&&d.has(p))),...Array.from(d)]}}if(t==="top"){var a,h;return{top:[...((a=c==null?void 0:c.top)!=null?a:[]).filter(p=>!(d!=null&&d.has(p))),...Array.from(d)],bottom:((h=c==null?void 0:c.bottom)!=null?h:[]).filter(p=>!(d!=null&&d.has(p)))}}return{top:((u=c==null?void 0:c.top)!=null?u:[]).filter(p=>!(d!=null&&d.has(p))),bottom:((g=c==null?void 0:c.bottom)!=null?g:[]).filter(p=>!(d!=null&&d.has(p)))}})},e.getCanPin=()=>{var t;const{enableRowPinning:n,enablePinning:r}=o.options;return typeof n=="function"?n(e):(t=n??r)!=null?t:!0},e.getIsPinned=()=>{const t=[e.id],{top:n,bottom:r}=o.getState().rowPinning,s=t.some(d=>n==null?void 0:n.includes(d)),l=t.some(d=>r==null?void 0:r.includes(d));return s?"top":l?"bottom":!1},e.getPinnedIndex=()=>{var t,n;const r=e.getIsPinned();if(!r)return-1;const s=(t=r==="top"?o.getTopRows():o.getBottomRows())==null?void 0:t.map(l=>{let{id:d}=l;return d});return(n=s==null?void 0:s.indexOf(e.id))!=null?n:-1}},createTable:e=>{e.setRowPinning=o=>e.options.onRowPinningChange==null?void 0:e.options.onRowPinningChange(o),e.resetRowPinning=o=>{var t,n;return e.setRowPinning(o?Ce():(t=(n=e.initialState)==null?void 0:n.rowPinning)!=null?t:Ce())},e.getIsSomeRowsPinned=o=>{var t;const n=e.getState().rowPinning;if(!o){var r,s;return!!((r=n.top)!=null&&r.length||(s=n.bottom)!=null&&s.length)}return!!((t=n[o])!=null&&t.length)},e._getPinnedRows=(o,t,n)=>{var r;return((r=e.options.keepPinnedRows)==null||r?(t??[]).map(l=>{const d=e.getRow(l,!0);return d.getIsAllParentsExpanded()?d:null}):(t??[]).map(l=>o.find(d=>d.id===l))).filter(Boolean).map(l=>({...l,position:n}))},e.getTopRows=S(()=>[e.getRowModel().rows,e.getState().rowPinning.top],(o,t)=>e._getPinnedRows(o,t,"top"),C(e.options,"debugRows","getTopRows")),e.getBottomRows=S(()=>[e.getRowModel().rows,e.getState().rowPinning.bottom],(o,t)=>e._getPinnedRows(o,t,"bottom"),C(e.options,"debugRows","getBottomRows")),e.getCenterRows=S(()=>[e.getRowModel().rows,e.getState().rowPinning.top,e.getState().rowPinning.bottom],(o,t,n)=>{const r=new Set([...t??[],...n??[]]);return o.filter(s=>!r.has(s.id))},C(e.options,"debugRows","getCenterRows"))}},Tt={getInitialState:e=>({rowSelection:{},...e}),getDefaultOptions:e=>({onRowSelectionChange:$("rowSelection",e),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:e=>{e.setRowSelection=o=>e.options.onRowSelectionChange==null?void 0:e.options.onRowSelectionChange(o),e.resetRowSelection=o=>{var t;return e.setRowSelection(o?{}:(t=e.initialState.rowSelection)!=null?t:{})},e.toggleAllRowsSelected=o=>{e.setRowSelection(t=>{o=typeof o<"u"?o:!e.getIsAllRowsSelected();const n={...t},r=e.getPreGroupedRowModel().flatRows;return o?r.forEach(s=>{s.getCanSelect()&&(n[s.id]=!0)}):r.forEach(s=>{delete n[s.id]}),n})},e.toggleAllPageRowsSelected=o=>e.setRowSelection(t=>{const n=typeof o<"u"?o:!e.getIsAllPageRowsSelected(),r={...t};return e.getRowModel().rows.forEach(s=>{Ie(r,s.id,n,!0,e)}),r}),e.getPreSelectedRowModel=()=>e.getCoreRowModel(),e.getSelectedRowModel=S(()=>[e.getState().rowSelection,e.getCoreRowModel()],(o,t)=>Object.keys(o).length?Ee(e,t):{rows:[],flatRows:[],rowsById:{}},C(e.options,"debugTable","getSelectedRowModel")),e.getFilteredSelectedRowModel=S(()=>[e.getState().rowSelection,e.getFilteredRowModel()],(o,t)=>Object.keys(o).length?Ee(e,t):{rows:[],flatRows:[],rowsById:{}},C(e.options,"debugTable","getFilteredSelectedRowModel")),e.getGroupedSelectedRowModel=S(()=>[e.getState().rowSelection,e.getSortedRowModel()],(o,t)=>Object.keys(o).length?Ee(e,t):{rows:[],flatRows:[],rowsById:{}},C(e.options,"debugTable","getGroupedSelectedRowModel")),e.getIsAllRowsSelected=()=>{const o=e.getFilteredRowModel().flatRows,{rowSelection:t}=e.getState();let n=!!(o.length&&Object.keys(t).length);return n&&o.some(r=>r.getCanSelect()&&!t[r.id])&&(n=!1),n},e.getIsAllPageRowsSelected=()=>{const o=e.getPaginationRowModel().flatRows.filter(r=>r.getCanSelect()),{rowSelection:t}=e.getState();let n=!!o.length;return n&&o.some(r=>!t[r.id])&&(n=!1),n},e.getIsSomeRowsSelected=()=>{var o;const t=Object.keys((o=e.getState().rowSelection)!=null?o:{}).length;return t>0&&t<e.getFilteredRowModel().flatRows.length},e.getIsSomePageRowsSelected=()=>{const o=e.getPaginationRowModel().flatRows;return e.getIsAllPageRowsSelected()?!1:o.filter(t=>t.getCanSelect()).some(t=>t.getIsSelected()||t.getIsSomeSelected())},e.getToggleAllRowsSelectedHandler=()=>o=>{e.toggleAllRowsSelected(o.target.checked)},e.getToggleAllPageRowsSelectedHandler=()=>o=>{e.toggleAllPageRowsSelected(o.target.checked)}},createRow:(e,o)=>{e.toggleSelected=(t,n)=>{const r=e.getIsSelected();o.setRowSelection(s=>{var l;if(t=typeof t<"u"?t:!r,e.getCanSelect()&&r===t)return s;const d={...s};return Ie(d,e.id,t,(l=n==null?void 0:n.selectChildren)!=null?l:!0,o),d})},e.getIsSelected=()=>{const{rowSelection:t}=o.getState();return Ne(e,t)},e.getIsSomeSelected=()=>{const{rowSelection:t}=o.getState();return ke(e,t)==="some"},e.getIsAllSubRowsSelected=()=>{const{rowSelection:t}=o.getState();return ke(e,t)==="all"},e.getCanSelect=()=>{var t;return typeof o.options.enableRowSelection=="function"?o.options.enableRowSelection(e):(t=o.options.enableRowSelection)!=null?t:!0},e.getCanSelectSubRows=()=>{var t;return typeof o.options.enableSubRowSelection=="function"?o.options.enableSubRowSelection(e):(t=o.options.enableSubRowSelection)!=null?t:!0},e.getCanMultiSelect=()=>{var t;return typeof o.options.enableMultiRowSelection=="function"?o.options.enableMultiRowSelection(e):(t=o.options.enableMultiRowSelection)!=null?t:!0},e.getToggleSelectedHandler=()=>{const t=e.getCanSelect();return n=>{var r;t&&e.toggleSelected((r=n.target)==null?void 0:r.checked)}}}},Ie=(e,o,t,n,r)=>{var s;const l=r.getRow(o,!0);t?(l.getCanMultiSelect()||Object.keys(e).forEach(d=>delete e[d]),l.getCanSelect()&&(e[o]=!0)):delete e[o],n&&(s=l.subRows)!=null&&s.length&&l.getCanSelectSubRows()&&l.subRows.forEach(d=>Ie(e,d.id,t,n,r))};function Ee(e,o){const t=e.getState().rowSelection,n=[],r={},s=function(l,d){return l.map(c=>{var u;const g=Ne(c,t);if(g&&(n.push(c),r[c.id]=c),(u=c.subRows)!=null&&u.length&&(c={...c,subRows:s(c.subRows)}),g)return c}).filter(Boolean)};return{rows:s(o.rows),flatRows:n,rowsById:r}}function Ne(e,o){var t;return(t=o[e.id])!=null?t:!1}function ke(e,o,t){var n;if(!((n=e.subRows)!=null&&n.length))return!1;let r=!0,s=!1;return e.subRows.forEach(l=>{if(!(s&&!r)&&(l.getCanSelect()&&(Ne(l,o)?s=!0:r=!1),l.subRows&&l.subRows.length)){const d=ke(l,o);d==="all"?s=!0:(d==="some"&&(s=!0),r=!1)}}),r?"all":s?"some":!1}const Fe=/([0-9]+)/gm,$t=(e,o,t)=>Ye(G(e.getValue(t)).toLowerCase(),G(o.getValue(t)).toLowerCase()),Vt=(e,o,t)=>Ye(G(e.getValue(t)),G(o.getValue(t))),Lt=(e,o,t)=>Me(G(e.getValue(t)).toLowerCase(),G(o.getValue(t)).toLowerCase()),Ot=(e,o,t)=>Me(G(e.getValue(t)),G(o.getValue(t))),Ht=(e,o,t)=>{const n=e.getValue(t),r=o.getValue(t);return n>r?1:n<r?-1:0},qt=(e,o,t)=>Me(e.getValue(t),o.getValue(t));function Me(e,o){return e===o?0:e>o?1:-1}function G(e){return typeof e=="number"?isNaN(e)||e===1/0||e===-1/0?"":String(e):typeof e=="string"?e:""}function Ye(e,o){const t=e.split(Fe).filter(Boolean),n=o.split(Fe).filter(Boolean);for(;t.length&&n.length;){const r=t.shift(),s=n.shift(),l=parseInt(r,10),d=parseInt(s,10),c=[l,d].sort();if(isNaN(c[0])){if(r>s)return 1;if(s>r)return-1;continue}if(isNaN(c[1]))return isNaN(l)?-1:1;if(l>d)return 1;if(d>l)return-1}return t.length-n.length}const ee={alphanumeric:$t,alphanumericCaseSensitive:Vt,text:Lt,textCaseSensitive:Ot,datetime:Ht,basic:qt},zt=[vt,kt,St,Ct,bt,xt,Ft,Mt,{getInitialState:e=>({sorting:[],...e}),getDefaultColumnDef:()=>({sortingFn:"auto",sortUndefined:1}),getDefaultOptions:e=>({onSortingChange:$("sorting",e),isMultiSortEvent:o=>o.shiftKey}),createColumn:(e,o)=>{e.getAutoSortingFn=()=>{const t=o.getFilteredRowModel().flatRows.slice(10);let n=!1;for(const r of t){const s=r==null?void 0:r.getValue(e.id);if(Object.prototype.toString.call(s)==="[object Date]")return ee.datetime;if(typeof s=="string"&&(n=!0,s.split(Fe).length>1))return ee.alphanumeric}return n?ee.text:ee.basic},e.getAutoSortDir=()=>{const t=o.getFilteredRowModel().flatRows[0];return typeof(t==null?void 0:t.getValue(e.id))=="string"?"asc":"desc"},e.getSortingFn=()=>{var t,n;if(!e)throw new Error;return ie(e.columnDef.sortingFn)?e.columnDef.sortingFn:e.columnDef.sortingFn==="auto"?e.getAutoSortingFn():(t=(n=o.options.sortingFns)==null?void 0:n[e.columnDef.sortingFn])!=null?t:ee[e.columnDef.sortingFn]},e.toggleSorting=(t,n)=>{const r=e.getNextSortingOrder(),s=typeof t<"u"&&t!==null;o.setSorting(l=>{const d=l==null?void 0:l.find(a=>a.id===e.id),c=l==null?void 0:l.findIndex(a=>a.id===e.id);let u=[],g,m=s?t:r==="desc";if(l!=null&&l.length&&e.getCanMultiSort()&&n?d?g="toggle":g="add":l!=null&&l.length&&c!==l.length-1?g="replace":d?g="toggle":g="replace",g==="toggle"&&(s||r||(g="remove")),g==="add"){var f;u=[...l,{id:e.id,desc:m}],u.splice(0,u.length-((f=o.options.maxMultiSortColCount)!=null?f:Number.MAX_SAFE_INTEGER))}else g==="toggle"?u=l.map(a=>a.id===e.id?{...a,desc:m}:a):g==="remove"?u=l.filter(a=>a.id!==e.id):u=[{id:e.id,desc:m}];return u})},e.getFirstSortDir=()=>{var t,n;return((t=(n=e.columnDef.sortDescFirst)!=null?n:o.options.sortDescFirst)!=null?t:e.getAutoSortDir()==="desc")?"desc":"asc"},e.getNextSortingOrder=t=>{var n,r;const s=e.getFirstSortDir(),l=e.getIsSorted();return l?l!==s&&((n=o.options.enableSortingRemoval)==null||n)&&(!(t&&(r=o.options.enableMultiRemove)!=null)||r)?!1:l==="desc"?"asc":"desc":s},e.getCanSort=()=>{var t,n;return((t=e.columnDef.enableSorting)!=null?t:!0)&&((n=o.options.enableSorting)!=null?n:!0)&&!!e.accessorFn},e.getCanMultiSort=()=>{var t,n;return(t=(n=e.columnDef.enableMultiSort)!=null?n:o.options.enableMultiSort)!=null?t:!!e.accessorFn},e.getIsSorted=()=>{var t;const n=(t=o.getState().sorting)==null?void 0:t.find(r=>r.id===e.id);return n?n.desc?"desc":"asc":!1},e.getSortIndex=()=>{var t,n;return(t=(n=o.getState().sorting)==null?void 0:n.findIndex(r=>r.id===e.id))!=null?t:-1},e.clearSorting=()=>{o.setSorting(t=>t!=null&&t.length?t.filter(n=>n.id!==e.id):[])},e.getToggleSortingHandler=()=>{const t=e.getCanSort();return n=>{t&&(n.persist==null||n.persist(),e.toggleSorting==null||e.toggleSorting(void 0,e.getCanMultiSort()?o.options.isMultiSortEvent==null?void 0:o.options.isMultiSortEvent(n):!1))}}},createTable:e=>{e.setSorting=o=>e.options.onSortingChange==null?void 0:e.options.onSortingChange(o),e.resetSorting=o=>{var t,n;e.setSorting(o?[]:(t=(n=e.initialState)==null?void 0:n.sorting)!=null?t:[])},e.getPreSortedRowModel=()=>e.getGroupedRowModel(),e.getSortedRowModel=()=>(!e._getSortedRowModel&&e.options.getSortedRowModel&&(e._getSortedRowModel=e.options.getSortedRowModel(e)),e.options.manualSorting||!e._getSortedRowModel?e.getPreSortedRowModel():e._getSortedRowModel())}},_t,At,Dt,Pt,Tt,Et];function Rt(e){var o,t;j.NODE_ENV!=="production"&&(e.debugAll||e.debugTable)&&console.info("Creating Table Instance...");const n=[...zt,...(o=e._features)!=null?o:[]];let r={_features:n};const s=r._features.reduce((f,a)=>Object.assign(f,a.getDefaultOptions==null?void 0:a.getDefaultOptions(r)),{}),l=f=>r.options.mergeOptions?r.options.mergeOptions(s,f):{...s,...f};let c={...{},...(t=e.initialState)!=null?t:{}};r._features.forEach(f=>{var a;c=(a=f.getInitialState==null?void 0:f.getInitialState(c))!=null?a:c});const u=[];let g=!1;const m={_features:n,options:{...s,...e},initialState:c,_queue:f=>{u.push(f),g||(g=!0,Promise.resolve().then(()=>{for(;u.length;)u.shift()();g=!1}).catch(a=>setTimeout(()=>{throw a})))},reset:()=>{r.setState(r.initialState)},setOptions:f=>{const a=U(f,r.options);r.options=l(a)},getState:()=>r.options.state,setState:f=>{r.options.onStateChange==null||r.options.onStateChange(f)},_getRowId:(f,a,h)=>{var p;return(p=r.options.getRowId==null?void 0:r.options.getRowId(f,a,h))!=null?p:`${h?[h.id,a].join("."):a}`},getCoreRowModel:()=>(r._getCoreRowModel||(r._getCoreRowModel=r.options.getCoreRowModel(r)),r._getCoreRowModel()),getRowModel:()=>r.getPaginationRowModel(),getRow:(f,a)=>{let h=(a?r.getPrePaginationRowModel():r.getRowModel()).rowsById[f];if(!h&&(h=r.getCoreRowModel().rowsById[f],!h))throw j.NODE_ENV!=="production"?new Error(`getRow could not find row with ID: ${f}`):new Error;return h},_getDefaultColumnDef:S(()=>[r.options.defaultColumn],f=>{var a;return f=(a=f)!=null?a:{},{header:h=>{const p=h.header.column.columnDef;return p.accessorKey?p.accessorKey:p.accessorFn?p.id:null},cell:h=>{var p,v;return(p=(v=h.renderValue())==null||v.toString==null?void 0:v.toString())!=null?p:null},...r._features.reduce((h,p)=>Object.assign(h,p.getDefaultColumnDef==null?void 0:p.getDefaultColumnDef()),{}),...f}},C(e,"debugColumns","_getDefaultColumnDef")),_getColumnDefs:()=>r.options.columns,getAllColumns:S(()=>[r._getColumnDefs()],f=>{const a=function(h,p,v){return v===void 0&&(v=0),h.map(b=>{const w=yt(r,b,v,p),_=b;return w.columns=_.columns?a(_.columns,w,v+1):[],w})};return a(f)},C(e,"debugColumns","getAllColumns")),getAllFlatColumns:S(()=>[r.getAllColumns()],f=>f.flatMap(a=>a.getFlatColumns()),C(e,"debugColumns","getAllFlatColumns")),_getAllFlatColumnsById:S(()=>[r.getAllFlatColumns()],f=>f.reduce((a,h)=>(a[h.id]=h,a),{}),C(e,"debugColumns","getAllFlatColumnsById")),getAllLeafColumns:S(()=>[r.getAllColumns(),r._getOrderColumnsFn()],(f,a)=>{let h=f.flatMap(p=>p.getLeafColumns());return a(h)},C(e,"debugColumns","getAllLeafColumns")),getColumn:f=>{const a=r._getAllFlatColumnsById()[f];return j.NODE_ENV!=="production"&&!a&&console.error(`[Table] Column with id '${f}' does not exist.`),a}};Object.assign(r,m);for(let f=0;f<r._features.length;f++){const a=r._features[f];a==null||a.createTable==null||a.createTable(r)}return r}function Ae(){return e=>S(()=>[e.options.data],o=>{const t={rows:[],flatRows:[],rowsById:{}},n=function(r,s,l){s===void 0&&(s=0);const d=[];for(let u=0;u<r.length;u++){const g=he(e,e._getRowId(r[u],u,l),r[u],u,s,void 0,l==null?void 0:l.id);if(t.flatRows.push(g),t.rowsById[g.id]=g,d.push(g),e.options.getSubRows){var c;g.originalSubRows=e.options.getSubRows(r[u],u),(c=g.originalSubRows)!=null&&c.length&&(g.subRows=n(g.originalSubRows,s+1,g))}}return d};return t.rows=n(o),t},C(e.options,"debugTable","getRowModel",()=>e._autoResetPageIndex()))}function Ut(e){const o=[],t=n=>{var r;o.push(n),(r=n.subRows)!=null&&r.length&&n.getIsExpanded()&&n.subRows.forEach(t)};return e.rows.forEach(t),{rows:o,flatRows:e.flatRows,rowsById:e.rowsById}}function Gt(e,o,t){return t.options.filterFromLeafRows?jt(e,o,t):Bt(e,o,t)}function jt(e,o,t){var n;const r=[],s={},l=(n=t.options.maxLeafRowFilterDepth)!=null?n:100,d=function(c,u){u===void 0&&(u=0);const g=[];for(let f=0;f<c.length;f++){var m;let a=c[f];const h=he(t,a.id,a.original,a.index,a.depth,void 0,a.parentId);if(h.columnFilters=a.columnFilters,(m=a.subRows)!=null&&m.length&&u<l){if(h.subRows=d(a.subRows,u+1),a=h,o(a)&&!h.subRows.length){g.push(a),s[a.id]=a,r.push(a);continue}if(o(a)||h.subRows.length){g.push(a),s[a.id]=a,r.push(a);continue}}else a=h,o(a)&&(g.push(a),s[a.id]=a,r.push(a))}return g};return{rows:d(e),flatRows:r,rowsById:s}}function Bt(e,o,t){var n;const r=[],s={},l=(n=t.options.maxLeafRowFilterDepth)!=null?n:100,d=function(c,u){u===void 0&&(u=0);const g=[];for(let f=0;f<c.length;f++){let a=c[f];if(o(a)){var m;if((m=a.subRows)!=null&&m.length&&u<l){const p=he(t,a.id,a.original,a.index,a.depth,void 0,a.parentId);p.subRows=d(a.subRows,u+1),a=p}g.push(a),r.push(a),s[a.id]=a}}return g};return{rows:d(e),flatRows:r,rowsById:s}}function De(){return e=>S(()=>[e.getPreFilteredRowModel(),e.getState().columnFilters,e.getState().globalFilter],(o,t,n)=>{if(!o.rows.length||!(t!=null&&t.length)&&!n){for(let f=0;f<o.flatRows.length;f++)o.flatRows[f].columnFilters={},o.flatRows[f].columnFiltersMeta={};return o}const r=[],s=[];(t??[]).forEach(f=>{var a;const h=e.getColumn(f.id);if(!h)return;const p=h.getFilterFn();if(!p){j.NODE_ENV!=="production"&&console.warn(`Could not find a valid 'column.filterFn' for column with the ID: ${h.id}.`);return}r.push({id:f.id,filterFn:p,resolvedValue:(a=p.resolveFilterValue==null?void 0:p.resolveFilterValue(f.value))!=null?a:f.value})});const l=(t??[]).map(f=>f.id),d=e.getGlobalFilterFn(),c=e.getAllLeafColumns().filter(f=>f.getCanGlobalFilter());n&&d&&c.length&&(l.push("__global__"),c.forEach(f=>{var a;s.push({id:f.id,filterFn:d,resolvedValue:(a=d.resolveFilterValue==null?void 0:d.resolveFilterValue(n))!=null?a:n})}));let u,g;for(let f=0;f<o.flatRows.length;f++){const a=o.flatRows[f];if(a.columnFilters={},r.length)for(let h=0;h<r.length;h++){u=r[h];const p=u.id;a.columnFilters[p]=u.filterFn(a,p,u.resolvedValue,v=>{a.columnFiltersMeta[p]=v})}if(s.length){for(let h=0;h<s.length;h++){g=s[h];const p=g.id;if(g.filterFn(a,p,g.resolvedValue,v=>{a.columnFiltersMeta[p]=v})){a.columnFilters.__global__=!0;break}}a.columnFilters.__global__!==!0&&(a.columnFilters.__global__=!1)}}const m=f=>{for(let a=0;a<l.length;a++)if(f.columnFilters[l[a]]===!1)return!1;return!0};return Gt(o.rows,m,e)},C(e.options,"debugTable","getFilteredRowModel",()=>e._autoResetPageIndex()))}function Ze(e){return o=>S(()=>[o.getState().pagination,o.getPrePaginationRowModel(),o.options.paginateExpandedRows?void 0:o.getState().expanded],(t,n)=>{if(!n.rows.length)return n;const{pageSize:r,pageIndex:s}=t;let{rows:l,flatRows:d,rowsById:c}=n;const u=r*s,g=u+r;l=l.slice(u,g);let m;o.options.paginateExpandedRows?m={rows:l,flatRows:d,rowsById:c}:m=Ut({rows:l,flatRows:d,rowsById:c}),m.flatRows=[];const f=a=>{m.flatRows.push(a),a.subRows.length&&a.subRows.forEach(f)};return m.rows.forEach(f),m},C(o.options,"debugTable","getPaginationRowModel"))}function Pe(){return e=>S(()=>[e.getState().sorting,e.getPreSortedRowModel()],(o,t)=>{if(!t.rows.length||!(o!=null&&o.length))return t;const n=e.getState().sorting,r=[],s=n.filter(c=>{var u;return(u=e.getColumn(c.id))==null?void 0:u.getCanSort()}),l={};s.forEach(c=>{const u=e.getColumn(c.id);u&&(l[c.id]={sortUndefined:u.columnDef.sortUndefined,invertSorting:u.columnDef.invertSorting,sortingFn:u.getSortingFn()})});const d=c=>{const u=c.map(g=>({...g}));return u.sort((g,m)=>{for(let a=0;a<s.length;a+=1){var f;const h=s[a],p=l[h.id],v=p.sortUndefined,b=(f=h==null?void 0:h.desc)!=null?f:!1;let w=0;if(v){const _=g.getValue(h.id),N=m.getValue(h.id),I=_===void 0,F=N===void 0;if(I||F){if(v==="first")return I?-1:1;if(v==="last")return I?1:-1;w=I&&F?0:I?v:-v}}if(w===0&&(w=p.sortingFn(g,m,h.id)),w!==0)return b&&(w*=-1),p.invertSorting&&(w*=-1),w}return g.index-m.index}),u.forEach(g=>{var m;r.push(g),(m=g.subRows)!=null&&m.length&&(g.subRows=d(g.subRows))}),u};return{rows:d(t.rows),flatRows:r,rowsById:t.rowsById}},C(e.options,"debugTable","getSortedRowModel",()=>e._autoResetPageIndex()))}/**
   * react-table
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function K(e,o){return e?Wt(e)?fe.createElement(e,o):e:null}function Wt(e){return Kt(e)||typeof e=="function"||Xt(e)}function Kt(e){return typeof e=="function"&&(()=>{const o=Object.getPrototypeOf(e);return o.prototype&&o.prototype.isReactComponent})()}function Xt(e){return typeof e=="object"&&typeof e.$$typeof=="symbol"&&["react.memo","react.forward_ref"].includes(e.$$typeof.description)}function Te(e){const o={state:{},onStateChange:()=>{},renderFallbackValue:null,...e},[t]=fe.useState(()=>({current:Rt(o)})),[n,r]=fe.useState(()=>t.current.initialState);return t.current.setOptions(s=>({...s,...e,state:{...n,...e.state},onStateChange:l=>{r(l),e.onStateChange==null||e.onStateChange(l)}})),t.current}/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Jt={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),E=(e,o)=>{const t=x.forwardRef(({color:n="currentColor",size:r=24,strokeWidth:s=2,absoluteStrokeWidth:l,className:d="",children:c,...u},g)=>x.createElement("svg",{ref:g,...Jt,width:r,height:r,stroke:n,strokeWidth:l?Number(s)*24/Number(r):s,className:["lucide",`lucide-${Yt(e)}`,d].join(" "),...u},[...o.map(([m,f])=>x.createElement(m,f)),...Array.isArray(c)?c:[c]]));return t.displayName=`${e}`,t};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=E("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=E("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=E("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const en=E("ArrowDownLeft",[["path",{d:"M17 7 7 17",key:"15tmo1"}],["path",{d:"M17 17H7V7",key:"1org7z"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=E("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=E("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=E("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tn=E("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=E("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=E("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nn=E("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=E("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const on=E("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=E("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=E("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=E("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=E("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=E("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=E("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dn=E("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=E("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const un=E("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gn=E("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=E("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fn=E("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pn=E("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=E("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mn=E("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=E("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yn=E("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vn=E("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bn=E("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xn=E("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=E("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=E("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=E("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=E("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),M="com.hubbi.inventory",_n="com.hubbi.accounting";function wn(){const[e,o]=x.useState([]),[t,n]=x.useState(null),[r,s]=x.useState(null),[l,d]=x.useState(!0),[c,u]=x.useState(null);x.useEffect(()=>{g()},[]);const g=async()=>{var I;d(!0),await m();const _=await y.db.query("SELECT * FROM hubbi_fiscal_config WHERE id = 'default'",[],{moduleId:M});_&&_.length>0&&s(_[0]),!await y.modules.isInstalled(_n)&&((I=_[0])==null?void 0:I.managed_by)!==M&&await y.db.execute("UPDATE hubbi_fiscal_config SET managed_by = ? WHERE id = 'default'",[M],{moduleId:M}),await f(),await a(),d(!1)},m=async()=>{await y.db.execute(`
      CREATE TABLE IF NOT EXISTS hubbi_fiscal_config (
        id TEXT PRIMARY KEY DEFAULT 'default',
        lock_after_periods INTEGER DEFAULT 2,
        auto_close BOOLEAN DEFAULT FALSE,
        period_type TEXT DEFAULT 'monthly',
        fiscal_year_start_month INTEGER DEFAULT 1,
        managed_by TEXT,
        created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
        updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
      )
    `,[],{moduleId:M}),await y.db.execute(`
      INSERT OR IGNORE INTO hubbi_fiscal_config (id, lock_after_periods, period_type)
      VALUES ('default', 2, 'monthly')
    `,[],{moduleId:M}),await y.db.execute(`
      CREATE TABLE IF NOT EXISTS hubbi_fiscal_periods (
        id TEXT PRIMARY KEY,
        year INTEGER NOT NULL,
        month INTEGER NOT NULL,
        quarter INTEGER,
        start_date DATE NOT NULL,
        end_date DATE NOT NULL,
        status TEXT DEFAULT 'open',
        is_current BOOLEAN DEFAULT FALSE,
        created_by_module TEXT,
        closed_by TEXT,
        closed_at DATETIME,
        locked_at DATETIME,
        created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
        UNIQUE(year, month)
      )
    `,[],{moduleId:M})},f=async()=>{const _=await y.db.query("SELECT * FROM hubbi_fiscal_periods WHERE is_current = TRUE",[],{moduleId:M});if(!_||_.length===0){const N=new Date,I=N.getFullYear(),F=N.getMonth()+1,V=`${I}-${String(F).padStart(2,"0")}`,H=new Date(I,F-1,1).toISOString().split("T")[0],k=new Date(I,F,0).toISOString().split("T")[0];await y.db.execute(`
        INSERT OR IGNORE INTO hubbi_fiscal_periods 
          (id, year, month, start_date, end_date, status, is_current, created_by_module)
        VALUES (?, ?, ?, ?, ?, 'open', TRUE, ?)
      `,[V,I,F,H,k,M],{moduleId:M})}},a=async()=>{const _=await y.db.query("SELECT * FROM hubbi_fiscal_periods ORDER BY year DESC, month DESC",[],{moduleId:M});if(_){o(_);const N=_.find(I=>I.is_current);n(N||null),!c&&N&&u(N.id)}},h=x.useCallback(_=>{if(!r||!t)return!1;const N=e.find(H=>H.id===_);if(!N||N.status==="closed"||N.status==="locked")return!1;const I=t.year*12+t.month,F=N.year*12+N.month;return I-F<=r.lock_after_periods},[r,t,e]);return{periods:e,currentPeriod:t,config:r,loading:l,selectedPeriodId:c,selectPeriod:_=>{u(_)},getSelectedPeriod:()=>e.find(_=>_.id===c)||t,isPeriodEditable:h,closePeriod:async(_,N)=>{const I=e.find(F=>F.id===_);if(!I||I.status!=="open")return!1;if(await y.db.execute(`UPDATE hubbi_fiscal_periods 
       SET status = 'closed', closed_by = ?, closed_at = ? 
       WHERE id = ?`,[N,new Date().toISOString(),_],{moduleId:M}),I.is_current){const F=I.month===12?1:I.month+1,V=I.month===12?I.year+1:I.year,H=`${V}-${String(F).padStart(2,"0")}`,k=new Date(V,F-1,1).toISOString().split("T")[0],T=new Date(V,F,0).toISOString().split("T")[0];await y.db.execute("UPDATE hubbi_fiscal_periods SET is_current = FALSE WHERE id = ?",[_],{moduleId:M}),await y.db.execute(`
        INSERT OR IGNORE INTO hubbi_fiscal_periods 
          (id, year, month, start_date, end_date, status, is_current, created_by_module)
        VALUES (?, ?, ?, ?, ?, 'open', TRUE, ?)
      `,[H,V,F,k,T,M],{moduleId:M})}return await a(),!0},updateConfig:async _=>{const N=[],I=[];_.lock_after_periods!==void 0&&(N.push("lock_after_periods = ?"),I.push(_.lock_after_periods)),_.auto_close!==void 0&&(N.push("auto_close = ?"),I.push(_.auto_close)),_.period_type!==void 0&&(N.push("period_type = ?"),I.push(_.period_type)),N.length>0&&(N.push("updated_at = ?"),I.push(new Date().toISOString()),I.push("default"),await y.db.execute(`UPDATE hubbi_fiscal_config SET ${N.join(", ")} WHERE id = ?`,I,{moduleId:M}),await g())},refreshPeriods:a}}async function He(){const e=await y.db.query("SELECT * FROM hubbi_fiscal_periods WHERE is_current = TRUE",[],{moduleId:M});return e&&e.length>0?e[0]:null}async function Sn(e){const o=await y.db.query("SELECT * FROM hubbi_fiscal_periods WHERE id = ?",[e],{moduleId:M});return o&&o.length>0?o[0]:null}async function st(e){const[o,t,n]=await Promise.all([Sn(e),He(),y.db.query("SELECT * FROM hubbi_fiscal_config WHERE id = 'default'",[],{moduleId:M})]);if(!o||!t||!n||n.length===0)return!1;const r=n[0];if(o.status==="closed"||o.status==="locked")return!1;const s=t.year*12+t.month,l=o.year*12+o.month;return s-l<=r.lock_after_periods}function Cn(){const[e,o]=x.useState({assignedSubHubId:null,activeSubHubId:null,subHubs:[],canViewAll:!1,canEditOwn:!0,canEditAll:!1,canSwitchActive:!1}),[t,n]=x.useState(!0);x.useEffect(()=>{r()},[]);const r=async()=>{n(!0);const g=y.getContext(),m=(g==null?void 0:g.subHubId)||null,f=y.permissions.has("inventory:view_all_subhubs"),a=y.permissions.has("inventory:edit_own_subhub"),h=y.permissions.has("inventory:edit_all_subhubs"),p=y.permissions.has("inventory:switch_active_subhub");let v=[];try{v=await y.subHubs.list()||[]}catch{v=[]}let b=m;if(p){const w=await y.settings.get("active_subhub_id");w&&v.some(_=>_.id===w)&&(b=w)}o({assignedSubHubId:m,activeSubHubId:b,subHubs:v,canViewAll:f,canEditOwn:a,canEditAll:h,canSwitchActive:p}),n(!1)},s=x.useCallback(async g=>e.canSwitchActive?(await y.settings.set("active_subhub_id",g),o(m=>({...m,activeSubHubId:g})),y.notify("Sucursal activa cambiada","success"),!0):(y.notify("No tienes permiso para cambiar de sucursal","error"),!1),[e.canSwitchActive]),l=x.useCallback(g=>!!(e.canEditAll||e.canEditOwn&&g===e.assignedSubHubId),[e.canEditAll,e.canEditOwn,e.assignedSubHubId]),d=x.useCallback((g="sub_hub_id")=>e.canViewAll?e.activeSubHubId?` AND ${g} = '${e.activeSubHubId}'`:"":e.assignedSubHubId?` AND ${g} = '${e.assignedSubHubId}'`:" AND 1=0",[e.canViewAll,e.activeSubHubId,e.assignedSubHubId]),c=x.useCallback(()=>e.canSwitchActive&&e.activeSubHubId?e.activeSubHubId:e.assignedSubHubId,[e.canSwitchActive,e.activeSubHubId,e.assignedSubHubId]),u=x.useCallback(()=>{const g=e.activeSubHubId||e.assignedSubHubId,m=e.subHubs.find(f=>f.id===g);return(m==null?void 0:m.name)||"Sin Sucursal"},[e.activeSubHubId,e.assignedSubHubId,e.subHubs]);return{...e,loading:t,setActiveSubHub:s,canEditSubHub:l,getSubHubWhereClause:d,getEffectiveSubHubId:c,getActiveSubHubName:u,refreshContext:r}}const In=[{value:"initial",label:"Carga Inicial",description:"Crear productos y establecer stock inicial"},{value:"adjust",label:"Ajuste Masivo",description:"Ajustar cantidades existentes (+/-)"},{value:"sync",label:"SincronizaciÃ³n",description:"Reemplazar stock actual con valores del Excel"}],lt=({onClose:e,onSuccess:o})=>{const[t,n]=x.useState(null),[r,s]=x.useState("initial"),[l,d]=x.useState(""),[c,u]=x.useState([]),[g,m]=x.useState([]),[f,a]=x.useState(!1),[h,p]=x.useState("upload"),[v,b]=x.useState({success:0,errors:0}),{currentPeriod:w,isPeriodEditable:_}=wn(),{getEffectiveSubHubId:N,canEditSubHub:I}=Cn();x.useState(()=>{(async()=>{const T=await y.db.query("SELECT id, name FROM com_hubbi_inventory_locations WHERE is_active = TRUE",[],{moduleId:"com.hubbi.inventory"});u(T),T.length>0&&d(T[0].id)})()});const F=x.useCallback(async k=>{var ge;const T=(ge=k.target.files)==null?void 0:ge[0];if(!T)return;n(T);const O=(await T.text()).split(`
`),W=O[0].toLowerCase().split(",").map(A=>A.trim()),Y=W.findIndex(A=>A.includes("sku")||A.includes("codigo")),oe=W.findIndex(A=>A.includes("name")||A.includes("nombre")),D=W.findIndex(A=>A.includes("qty")||A.includes("quantity")||A.includes("cantidad")),Z=W.findIndex(A=>A.includes("cost")||A.includes("costo")||A.includes("precio"));if(Y===-1||D===-1){y.notify("El archivo debe tener columnas SKU y Cantidad","error");return}const z=[];for(let A=1;A<O.length;A++){const re=O[A].split(",").map(Kn=>Kn.trim());re[Y]&&z.push({sku:re[Y],name:oe>=0?re[oe]:void 0,quantity:parseFloat(re[D])||0,cost:Z>=0?parseFloat(re[Z]):void 0})}m(z),p("preview")},[]),V=async()=>{var W,Y,oe;if(w&&!_(w.id)){y.notify("El perÃ­odo actual estÃ¡ cerrado","error");return}const k=N();if(k&&!I(k)){y.notify("No tienes permiso para editar esta sucursal","error");return}if(!await((Y=(W=y.auth).requireRevalidation)==null?void 0:Y.call(W,"ImportaciÃ³n masiva de inventario"))){y.notify("RevalidaciÃ³n de identidad cancelada","warning");return}a(!0);let q=0,O=0;for(const D of g)try{const Z=await y.db.query("SELECT id FROM com_hubbi_inventory_items WHERE sku = ?",[D.sku],{moduleId:"com.hubbi.inventory"});let z;if(Z.length===0&&r==="initial"&&D.name)z=crypto.randomUUID(),await y.db.execute(`
            INSERT INTO com_hubbi_inventory_items (id, sku, name, weighted_average_cost, is_active)
            VALUES (?, ?, ?, ?, TRUE)
          `,[z,D.sku,D.name,D.cost||0],{moduleId:"com.hubbi.inventory"});else if(Z.length>0)z=Z[0].id;else{D.error="Producto no encontrado",O++;continue}if(r==="initial")await y.db.execute(`
            INSERT INTO com_hubbi_inventory_stock (item_id, location_id, quantity)
            VALUES (?, ?, ?)
            ON CONFLICT(item_id, location_id) DO UPDATE SET quantity = ?
          `,[z,l,D.quantity,D.quantity],{moduleId:"com.hubbi.inventory"});else if(r==="adjust"){const ge=crypto.randomUUID();await y.db.execute(`
            INSERT INTO com_hubbi_inventory_movements 
              (id, item_id, location_id, type, reason, quantity, created_by, period_id)
            VALUES (?, ?, ?, 'ADJUST', 'excel_import', ?, ?, ?)
          `,[ge,z,l,D.quantity,(oe=y.getContext())==null?void 0:oe.userId,w==null?void 0:w.id],{moduleId:"com.hubbi.inventory"}),await y.db.execute(`
            INSERT INTO com_hubbi_inventory_stock (item_id, location_id, quantity)
            VALUES (?, ?, ?)
            ON CONFLICT(item_id, location_id) DO UPDATE SET quantity = quantity + ?
          `,[z,l,D.quantity,D.quantity],{moduleId:"com.hubbi.inventory"})}else r==="sync"&&await y.db.execute(`
            INSERT INTO com_hubbi_inventory_stock (item_id, location_id, quantity)
            VALUES (?, ?, ?)
            ON CONFLICT(item_id, location_id) DO UPDATE SET quantity = ?
          `,[z,l,D.quantity,D.quantity],{moduleId:"com.hubbi.inventory"});q++}catch{D.error="Error al procesar",O++}b({success:q,errors:O}),p("result"),a(!1),q>0&&(o==null||o(q))},H=()=>{const k=`SKU,Nombre,Cantidad,Costo
PROD-001,Producto Ejemplo,100,25.50
`,T=new Blob([k],{type:"text/csv"}),q=URL.createObjectURL(T),O=document.createElement("a");O.href=q,O.download="plantilla_inventario.csv",O.click()};return i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-hidden flex flex-col",children:[i.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[i.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[i.jsx(an,{className:"text-green-600",size:20}),"Importar desde Excel"]}),i.jsx("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded",children:i.jsx(Oe,{size:20,className:"text-gray-500"})})]}),i.jsxs("div",{className:"p-6 flex-1 overflow-auto",children:[h==="upload"&&i.jsxs("div",{className:"space-y-5",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Modo de importaciÃ³n"}),i.jsx("div",{className:"space-y-2",children:In.map(k=>i.jsxs("label",{className:`flex items-start gap-3 p-3 rounded-lg border cursor-pointer ${r===k.value?"border-green-500 bg-green-50":"border-gray-200 hover:bg-gray-50"}`,children:[i.jsx("input",{type:"radio",name:"mode",value:k.value,checked:r===k.value,onChange:()=>s(k.value),className:"mt-1"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:k.label}),i.jsx("div",{className:"text-sm text-gray-500",children:k.description})]})]},k.value))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bodega destino"}),i.jsx("select",{value:l,onChange:k=>d(k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:c.map(k=>i.jsx("option",{value:k.id,children:k.name},k.id))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Archivo"}),i.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-green-500 transition-colors",children:[i.jsx(ce,{size:40,className:"mx-auto text-gray-400 mb-3"}),i.jsx("p",{className:"text-gray-600 mb-2",children:"Arrastra tu archivo Excel o CSV aquÃ­"}),i.jsx("input",{type:"file",accept:".csv,.xlsx,.xls",onChange:F,className:"hidden",id:"excel-input"}),i.jsx("label",{htmlFor:"excel-input",className:"inline-block px-4 py-2 bg-green-600 text-white rounded-lg cursor-pointer hover:bg-green-700",children:"Seleccionar archivo"})]})]}),i.jsxs("button",{onClick:H,className:"flex items-center gap-2 text-green-600 hover:text-green-700 text-sm",children:[i.jsx(ln,{size:16}),"Descargar plantilla de ejemplo"]})]}),h==="preview"&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("p",{className:"text-sm text-gray-600",children:[g.length," productos encontrados en ",t==null?void 0:t.name]}),i.jsx("button",{onClick:()=>p("upload"),className:"text-sm text-blue-600 hover:underline",children:"Cambiar archivo"})]}),i.jsx("div",{className:"border rounded-lg overflow-hidden max-h-64 overflow-auto",children:i.jsxs("table",{className:"w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50 sticky top-0",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-3 py-2 text-left",children:"SKU"}),i.jsx("th",{className:"px-3 py-2 text-left",children:"Nombre"}),i.jsx("th",{className:"px-3 py-2 text-right",children:"Cantidad"}),i.jsx("th",{className:"px-3 py-2 text-right",children:"Costo"})]})}),i.jsx("tbody",{children:g.slice(0,50).map((k,T)=>i.jsxs("tr",{className:k.error?"bg-red-50":"hover:bg-gray-50",children:[i.jsx("td",{className:"px-3 py-2 font-mono",children:k.sku}),i.jsx("td",{className:"px-3 py-2",children:k.name||"-"}),i.jsx("td",{className:"px-3 py-2 text-right",children:k.quantity}),i.jsx("td",{className:"px-3 py-2 text-right",children:k.cost??"-"})]},T))})]})}),g.length>50&&i.jsxs("p",{className:"text-sm text-gray-500 text-center",children:["Mostrando 50 de ",g.length," productos"]})]}),h==="result"&&i.jsxs("div",{className:"text-center py-8",children:[v.errors===0?i.jsx($e,{size:48,className:"mx-auto text-green-600 mb-4"}):i.jsx(Qt,{size:48,className:"mx-auto text-amber-500 mb-4"}),i.jsx("h3",{className:"text-xl font-semibold mb-2",children:"ImportaciÃ³n completada"}),i.jsxs("p",{className:"text-gray-600",children:[v.success," productos importados exitosamente",v.errors>0&&`, ${v.errors} errores`]})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 px-6 py-4 border-t bg-gray-50",children:[i.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg",children:h==="result"?"Cerrar":"Cancelar"}),h==="preview"&&i.jsxs("button",{onClick:V,disabled:f||g.length===0,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 flex items-center gap-2",children:[i.jsx(ce,{size:16}),f?"Importando...":`Importar ${g.length} productos`]})]})]})})},X=pe(),at=()=>{const[e,o]=x.useState([]),[t,n]=x.useState(!0),[r,s]=x.useState([]),[l,d]=x.useState(""),[c,u]=x.useState([]),[g,m]=x.useState(!1),f=x.useCallback(async()=>{n(!0);const{data:b,error:w}=await y.data.list({table:"com_hubbi_inventory_items",options:{strategy:"cache_first"}});b?o(b):w&&(console.error(w),y.notify.error("Error al cargar inventario")),n(!1)},[]),a=x.useCallback(()=>f(),[f]);x.useEffect(()=>(f(),y.events.on("inventory:item:created",a),y.events.on("inventory:item:updated",a),()=>{y.events.off("inventory:item:created",a),y.events.off("inventory:item:updated",a)}),[f,a]);const h=b=>{switch(b){case"kit":return i.jsx(de,{size:18,className:"text-blue-500"});case"serialized":return i.jsx(Zt,{size:18,className:"text-purple-500"});case"asset":return i.jsx(Le,{size:18,className:"text-orange-500"});default:return i.jsx(nn,{size:18,className:"text-gray-500"})}},p=x.useMemo(()=>[X.accessor("name",{header:"Producto",cell:b=>i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"font-medium text-gray-900",children:b.getValue()}),b.row.original.description&&i.jsx("span",{className:"text-xs text-gray-400 truncate max-w-xs",children:b.row.original.description})]})}),X.accessor("sku",{header:"SKU",cell:b=>i.jsx("span",{className:"font-mono text-gray-600",children:b.getValue()})}),X.accessor("type",{header:"Tipo",cell:b=>i.jsxs("div",{className:"flex items-center gap-2",title:b.getValue(),children:[h(b.getValue()),i.jsx("span",{className:"text-sm capitalize text-gray-600",children:b.getValue()})]})}),X.accessor("weighted_average_cost",{header:()=>i.jsx("div",{className:"text-right",children:"Costo Prom."}),cell:b=>i.jsxs("div",{className:"text-right font-mono",children:["$",b.getValue().toFixed(2)]})}),X.accessor("is_active",{header:()=>i.jsx("div",{className:"text-center",children:"Estado"}),cell:b=>i.jsx("div",{className:"text-center",children:i.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${b.getValue()?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:b.getValue()?"Activo":"Inactivo"})})}),X.display({id:"actions",header:()=>i.jsx("div",{className:"text-right",children:"Acciones"}),cell:()=>i.jsxs("div",{className:"flex items-center justify-end gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[i.jsx("button",{className:"p-1 hover:bg-gray-200 rounded text-gray-500 hover:text-blue-600",children:i.jsx(fn,{size:16})}),i.jsx("button",{className:"p-1 hover:bg-gray-200 rounded text-gray-500 hover:text-red-600",children:i.jsx(bn,{size:16})})]})})],[]),v=Te({data:e,columns:p,state:{sorting:r,globalFilter:l,columnFilters:c},onSortingChange:s,onGlobalFilterChange:d,onColumnFiltersChange:u,getCoreRowModel:Ae(),getSortedRowModel:Pe(),getFilteredRowModel:De(),getPaginationRowModel:Ze()});return i.jsxs("div",{className:"flex flex-col h-full bg-white rounded-lg shadow-sm",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("div",{className:"relative",children:[i.jsx(rt,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),i.jsx("input",{type:"text",placeholder:"Buscar por SKU o Nombre...",className:"pl-10 pr-4 py-2 border rounded-lg text-sm w-64 focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500",value:l,onChange:b=>d(b.target.value)})]}),i.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[i.jsx(cn,{size:18,className:"text-gray-400"}),i.jsxs("select",{className:"text-sm border-none bg-transparent focus:ring-0 cursor-pointer text-gray-600 font-medium",onChange:b=>{var _;const w=b.target.value;(_=v.getColumn("type"))==null||_.setFilterValue(w==="all"?void 0:w)},children:[i.jsx("option",{value:"all",children:"Todos los tipos"}),i.jsx("option",{value:"simple",children:"Simples"}),i.jsx("option",{value:"kit",children:"Kits"}),i.jsx("option",{value:"serialized",children:"Serializados"}),i.jsx("option",{value:"asset",children:"Activos (Camiones)"})]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:()=>{m(!0)},className:"flex items-center gap-2 bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:[i.jsx(ce,{size:18}),"Importar"]}),i.jsxs("button",{className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:[i.jsx(pn,{size:18}),"Nuevo Producto"]})]})]}),g&&i.jsx(lt,{onClose:()=>m(!1),onSuccess:a}),i.jsx("div",{className:"flex-1 overflow-auto",children:i.jsxs("table",{className:"w-full text-left border-collapse",children:[i.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:v.getHeaderGroups().map(b=>i.jsx("tr",{children:b.headers.map(w=>i.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors",onClick:w.column.getToggleSortingHandler(),children:i.jsxs("div",{className:"flex items-center gap-1",children:[K(w.column.columnDef.header,w.getContext()),w.column.getCanSort()&&i.jsx(B,{size:12,className:"text-gray-400"})]})},w.id))},b.id))}),i.jsx("tbody",{className:"divide-y divide-gray-100",children:t?i.jsx("tr",{children:i.jsx("td",{colSpan:p.length,className:"text-center py-12 text-gray-400",children:"Cargando inventario..."})}):v.getRowModel().rows.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:p.length,className:"text-center py-12 text-gray-400",children:"No se encontraron productos"})}):v.getRowModel().rows.map(b=>i.jsx("tr",{className:"hover:bg-gray-50/50 transition-colors group",children:b.getVisibleCells().map(w=>i.jsx("td",{className:"px-6 py-3 text-sm",children:K(w.column.columnDef.cell,w.getContext())},w.id))},b.id))})]})}),v.getPageCount()>1&&i.jsxs("div",{className:"flex items-center justify-between p-4 border-t border-gray-100",children:[i.jsxs("div",{className:"text-xs text-gray-500",children:["PÃ¡gina ",v.getState().pagination.pageIndex+1," de ",v.getPageCount()]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1 border rounded text-xs disabled:opacity-50",onClick:()=>v.previousPage(),disabled:!v.getCanPreviousPage(),children:"Anterior"}),i.jsx("button",{className:"px-3 py-1 border rounded text-xs disabled:opacity-50",onClick:()=>v.nextPage(),disabled:!v.getCanNextPage(),children:"Siguiente"})]})]})]})},J=pe(),En=({item:e})=>{const[o,t]=x.useState([]),[n,r]=x.useState(!0),[s,l]=x.useState([]),[d,c]=x.useState(""),u=x.useCallback(async()=>{r(!0);let a="SELECT * FROM com_hubbi_inventory_movements ORDER BY created_at DESC LIMIT 500",h=[];e&&(a="SELECT * FROM com_hubbi_inventory_movements WHERE item_id = ? ORDER BY created_at DESC LIMIT 500",h=[e.id]);const p=await y.data.query(a,h);p&&Array.isArray(p)&&t(p),r(!1)},[e]);x.useEffect(()=>{u();const a=()=>u();return y.events.on("inventory:stock:increased",a),y.events.on("inventory:stock:decreased",a),()=>{y.events.off("inventory:stock:increased",a),y.events.off("inventory:stock:increased",a),y.events.off("inventory:stock:decreased",a)}},[e,u]);const g=a=>{switch(a){case"IN":return i.jsx(en,{className:"text-green-600",size:16});case"OUT":return i.jsx(tn,{className:"text-red-600",size:16});case"ADJUST":return i.jsx(dn,{className:"text-gray-600",size:16});default:return i.jsx(Qe,{className:"text-blue-600",size:16})}},m=x.useMemo(()=>[J.accessor("type",{header:({column:a})=>i.jsxs("button",{onClick:()=>a.toggleSorting(),className:"flex items-center gap-1",children:["Tipo ",i.jsx(B,{size:14})]}),cell:a=>i.jsxs("div",{className:"flex items-center gap-2",children:[g(a.getValue()),i.jsx("span",{className:"font-medium",children:a.getValue()})]})}),J.accessor("created_at",{header:({column:a})=>i.jsxs("button",{onClick:()=>a.toggleSorting(),className:"flex items-center gap-1",children:["Fecha ",i.jsx(B,{size:14})]}),cell:a=>new Date(a.getValue()).toLocaleString()}),J.accessor("reason",{header:"Motivo",cell:a=>i.jsx("div",{className:"max-w-xs truncate",title:a.getValue()||"",children:a.getValue()||"-"})}),J.accessor("quantity",{header:({column:a})=>i.jsxs("button",{onClick:()=>a.toggleSorting(),className:"flex items-center gap-1 ml-auto",children:["Cantidad ",i.jsx(B,{size:14})]}),cell:a=>{const p=a.row.original.type==="OUT";return i.jsxs("span",{className:`font-mono font-medium ${p?"text-red-600":"text-green-600"}`,children:[p?"-":"+",a.getValue()]})}}),J.accessor("cost_at_moment",{header:"Costo Unit.",cell:a=>i.jsxs("span",{className:"font-mono",children:["$",a.getValue().toFixed(2)]})}),J.accessor("total_value",{header:({column:a})=>i.jsxs("button",{onClick:()=>a.toggleSorting(),className:"flex items-center gap-1 ml-auto",children:["Total ",i.jsx(B,{size:14})]}),cell:a=>i.jsxs("span",{className:"font-mono font-medium",children:["$",a.getValue().toFixed(2)]})})],[]),f=Te({data:o,columns:m,state:{sorting:s,globalFilter:d},onSortingChange:l,onGlobalFilterChange:c,getCoreRowModel:Ae(),getSortedRowModel:Pe(),getFilteredRowModel:De(),getPaginationRowModel:Ze(),initialState:{pagination:{pageSize:20}}});return i.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[i.jsxs("div",{className:"p-4 border-b border-gray-100 flex items-center justify-between",children:[i.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[i.jsx(ot,{size:16}),"Historial de Movimientos"]}),i.jsx("input",{type:"text",placeholder:"Buscar...",value:d,onChange:a=>c(a.target.value),className:"px-3 py-1.5 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full text-left text-sm",children:[i.jsx("thead",{className:"bg-gray-50 text-gray-500",children:f.getHeaderGroups().map(a=>i.jsx("tr",{children:a.headers.map(h=>i.jsx("th",{className:"px-4 py-2 font-medium",children:K(h.column.columnDef.header,h.getContext())},h.id))},a.id))}),i.jsx("tbody",{className:"divide-y divide-gray-100",children:n?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-8 text-gray-400",children:"Cargando..."})}):f.getRowModel().rows.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-8 text-gray-400",children:"No hay movimientos registrados"})}):f.getRowModel().rows.map(a=>i.jsx("tr",{className:"hover:bg-gray-50",children:a.getVisibleCells().map(h=>i.jsx("td",{className:"px-4 py-3",children:K(h.column.columnDef.cell,h.getContext())},h.id))},a.id))})]})}),i.jsxs("div",{className:"p-4 border-t border-gray-100 flex items-center justify-between text-sm text-gray-600",children:[i.jsxs("span",{children:["Mostrando ",f.getState().pagination.pageIndex*f.getState().pagination.pageSize+1," - ",Math.min((f.getState().pagination.pageIndex+1)*f.getState().pagination.pageSize,o.length)," de ",o.length]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>f.previousPage(),disabled:!f.getCanPreviousPage(),className:"p-1 rounded hover:bg-gray-100 disabled:opacity-50",children:i.jsx(on,{size:18})}),i.jsxs("span",{children:["PÃ¡gina ",f.getState().pagination.pageIndex+1," de ",f.getPageCount()]}),i.jsx("button",{onClick:()=>f.nextPage(),disabled:!f.getCanNextPage(),className:"p-1 rounded hover:bg-gray-100 disabled:opacity-50",children:i.jsx(rn,{size:18})})]})]})]})},Nn=()=>{const[e,o]=x.useState([]),t=async()=>{const s=await y.data.query("SELECT * FROM com_hubbi_inventory_transfer_requests ORDER BY created_at DESC");if(s&&Array.isArray(s)){const l=s.map(d=>({...d,items:typeof d.items=="string"?JSON.parse(d.items):d.items}));o(l)}};x.useEffect(()=>{t()},[]);const n=async(s,l)=>{await y.data.update({table:"com_hubbi_inventory_transfer_requests",id:s,data:{status:l,updated_at:new Date().toISOString()},options:{strategy:"online_first"}}),y.notify.success(`Solicitud ${l}`),t()},r=s=>{switch(s){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-blue-100 text-blue-800";case"in_transit":return"bg-purple-100 text-purple-800";case"received":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return i.jsxs("div",{className:"bg-white rounded-lg shadow-sm h-full flex flex-col",children:[i.jsxs("div",{className:"p-4 border-b border-gray-100 flex items-center justify-between",children:[i.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[i.jsx(yn,{size:18,className:"text-blue-600"}),"GestiÃ³n de Traslados"]}),i.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full text-gray-500",children:i.jsx(ot,{size:16})})]}),i.jsx("div",{className:"flex-1 overflow-auto p-4 space-y-4",children:e.length===0?i.jsx("div",{className:"text-center py-10 text-gray-400",children:"No hay solicitudes de traslado activas"}):e.map(s=>i.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 flex flex-col gap-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[i.jsxs("span",{className:"font-medium text-gray-900",children:["#",s.source_location_id.substring(0,4),"..."]}),i.jsx(et,{size:14}),i.jsxs("span",{className:"font-medium text-gray-900",children:["#",s.target_location_id.substring(0,4),"..."]})]}),i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium uppercase ${r(s.status)}`,children:s.status.replace("_"," ")})]}),i.jsx("div",{className:"bg-gray-50 p-3 rounded text-sm text-gray-600 space-y-1",children:s.items.map((l,d)=>i.jsxs("div",{className:"flex justify-between",children:[i.jsxs("span",{children:["Item ID: ",l.item_id.substring(0,8),"..."]}),i.jsxs("span",{className:"font-mono font-medium",children:["x",l.quantity]})]},d))}),s.status==="pending"&&i.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t border-gray-100",children:[i.jsxs("button",{onClick:()=>n(s.id,"rejected"),className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-red-600 hover:bg-red-50 rounded bg-white border border-red-200",children:[i.jsx(Oe,{size:14})," Rechazar"]}),i.jsxs("button",{onClick:()=>n(s.id,"approved"),className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-green-600 hover:bg-green-50 rounded bg-white border border-green-200",children:[i.jsx($e,{size:14})," Aprobar"]})]}),s.status==="approved"&&i.jsx("div",{className:"flex justify-end gap-2 pt-2",children:i.jsxs("button",{onClick:()=>n(s.id,"in_transit"),className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-purple-600 hover:bg-purple-50 rounded bg-white border border-purple-200",children:[i.jsx(Le,{size:14})," Despachar (Enviar)"]})})]},s.id))})]})},ue=pe(),kn=()=>{const[e,o]=x.useState([]),[t,n]=x.useState(null),[r,s]=x.useState(!1),[l,d]=x.useState([]),[c,u]=x.useState("");x.useEffect(()=>{(async()=>{const v=await y.data.query("SELECT * FROM com_hubbi_inventory_audits ORDER BY started_at DESC LIMIT 10");v&&Array.isArray(v)&&o(v.map(b=>({...b,lines:[]})))})()},[]);const g=async p=>{s(!0);const v=crypto.randomUUID(),b=await y.data.query(`SELECT s.item_id, s.quantity, i.name, i.sku 
             FROM com_hubbi_inventory_stock s 
             JOIN com_hubbi_inventory_items i ON s.item_id = i.id
             WHERE s.location_id = ?`,[p]);await y.data.execute("INSERT INTO com_hubbi_inventory_audits (id, location_id, status, started_at) VALUES (?, ?, 'open', ?)",[v,p,new Date().toISOString()]);for(const _ of b||[])await y.data.execute("INSERT INTO com_hubbi_inventory_audit_lines (audit_id, item_id, expected_qty) VALUES (?, ?, ?)",[v,_.item_id,_.quantity]);const w={id:v,location_id:p,status:"open",started_at:new Date().toISOString(),lines:(b||[]).map(_=>({item_id:_.item_id,item_name:_.name,item_sku:_.sku,expected_qty:_.quantity,counted_qty:null,difference:null,notes:""}))};n(w),o([w,...e]),s(!1),y.notify.success("AuditorÃ­a iniciada")},m=x.useCallback((p,v,b)=>{t&&n({...t,lines:t.lines.map(w=>w.item_id===p?{...w,counted_qty:v,difference:v-w.expected_qty,notes:b||w.notes}:w)})},[t]),f=async()=>{if(t){s(!0);for(const p of t.lines)if(p.counted_qty!==null&&(await y.data.execute(`UPDATE com_hubbi_inventory_audit_lines 
                     SET counted_qty = ?, difference = ?, notes = ? 
                     WHERE audit_id = ? AND item_id = ?`,[p.counted_qty,p.difference,p.notes,t.id,p.item_id]),p.difference!==0)){const v=crypto.randomUUID();await y.data.execute(`INSERT INTO com_hubbi_inventory_movements (id, item_id, location_id, type, reason, quantity, created_by, created_at)
                         VALUES (?, ?, ?, 'ADJUST', 'Ajuste por auditorÃ­a fÃ­sica', ?, 'audit_system', ?)`,[v,p.item_id,t.location_id,Math.abs(p.difference),new Date().toISOString()]),await y.data.execute("UPDATE com_hubbi_inventory_stock SET quantity = ? WHERE item_id = ? AND location_id = ?",[p.counted_qty,p.item_id,t.location_id])}await y.data.execute("UPDATE com_hubbi_inventory_audits SET status = 'closed', closed_at = ? WHERE id = ?",[new Date().toISOString(),t.id]),y.notify.success("AuditorÃ­a finalizada. Ajustes aplicados."),n(null),s(!1)}},a=x.useMemo(()=>[ue.accessor("item_name",{header:({column:p})=>i.jsxs("button",{onClick:()=>p.toggleSorting(),className:"flex items-center gap-1",children:["Producto ",i.jsx(B,{size:14})]}),cell:p=>i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:p.getValue()}),i.jsx("div",{className:"text-xs text-gray-400 font-mono",children:p.row.original.item_sku})]})}),ue.accessor("expected_qty",{header:({column:p})=>i.jsxs("button",{onClick:()=>p.toggleSorting(),className:"flex items-center gap-1",children:["Esperado ",i.jsx(B,{size:14})]}),cell:p=>i.jsx("span",{className:"font-mono",children:p.getValue()})}),ue.display({id:"counted",header:"Contado",cell:({row:p})=>{const v=p.original;return i.jsx("input",{type:"number",className:"w-20 text-center border rounded-lg py-1 font-mono",value:v.counted_qty??"",onChange:b=>m(v.item_id,parseInt(b.target.value)||0),disabled:(t==null?void 0:t.status)!=="open"})}}),ue.accessor("difference",{header:"Diferencia",cell:p=>{const v=p.getValue();if(v===null)return null;const b=v===0?"bg-green-100 text-green-700":v>0?"bg-blue-100 text-blue-700":"bg-red-100 text-red-700";return i.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-bold ${b}`,children:[v===0?i.jsx($e,{size:12}):i.jsx(te,{size:12}),v>0?"+":"",v]})}})],[t,m]),h=Te({data:(t==null?void 0:t.lines)||[],columns:a,state:{sorting:l,globalFilter:c},onSortingChange:d,onGlobalFilterChange:u,getCoreRowModel:Ae(),getSortedRowModel:Pe(),getFilteredRowModel:De()});return i.jsxs("div",{className:"flex h-full bg-white rounded-lg shadow-sm overflow-hidden",children:[i.jsxs("div",{className:"w-72 border-r border-gray-200 bg-gray-50 flex flex-col",children:[i.jsx("div",{className:"p-4 border-b border-gray-200",children:i.jsxs("h2",{className:"font-bold text-gray-900 flex items-center gap-2",children:[i.jsx(Ve,{size:20,className:"text-blue-600"}),"AuditorÃ­as FÃ­sicas"]})}),i.jsx("div",{className:"p-4",children:i.jsx("button",{onClick:()=>g("default-location"),disabled:r,className:"w-full bg-blue-600 text-white py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:opacity-50",children:"+ Nueva AuditorÃ­a"})}),i.jsx("div",{className:"flex-1 overflow-auto p-2 space-y-2",children:e.map(p=>i.jsxs("button",{onClick:()=>n(p),className:`w-full text-left p-3 rounded-lg border transition-colors ${(t==null?void 0:t.id)===p.id?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:bg-gray-50"}`,children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:new Date(p.started_at).toLocaleDateString()}),i.jsx("div",{className:"text-xs text-gray-500",children:p.status==="open"?"ðŸŸ¡ Abierta":"ðŸŸ¢ Cerrada"})]},p.id))})]}),i.jsx("div",{className:"flex-1 flex flex-col",children:t?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"p-4 border-b border-gray-100 flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-bold text-gray-900",children:"Conteo en Progreso"}),i.jsxs("p",{className:"text-sm text-gray-500",children:[t.lines.length," productos"]})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"relative",children:[i.jsx(rt,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),i.jsx("input",{type:"text",placeholder:"Buscar...",value:c,onChange:p=>u(p.target.value),className:"pl-9 pr-4 py-1.5 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.status==="open"&&i.jsxs("button",{onClick:f,disabled:r,className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 disabled:opacity-50",children:[i.jsx(mn,{size:18})," Finalizar"]})]})]}),i.jsx("div",{className:"flex-1 overflow-auto",children:i.jsxs("table",{className:"w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50 sticky top-0",children:h.getHeaderGroups().map(p=>i.jsx("tr",{children:p.headers.map(v=>i.jsx("th",{className:"text-left p-3 font-semibold text-gray-600",children:K(v.column.columnDef.header,v.getContext())},v.id))},p.id))}),i.jsx("tbody",{className:"divide-y divide-gray-100",children:h.getRowModel().rows.map(p=>i.jsx("tr",{className:"hover:bg-gray-50",children:p.getVisibleCells().map(v=>i.jsx("td",{className:"p-3",children:K(v.column.columnDef.cell,v.getContext())},v.id))},p.id))})]})})]}):i.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-400",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Ve,{size:48,className:"mx-auto mb-4 opacity-30"}),i.jsx("p",{children:"Selecciona o crea una auditorÃ­a"})]})})})]})},Fn=()=>{const[e,o]=x.useState([]),[t,n]=x.useState(!0),[r,s]=x.useState(null),l=x.useCallback(async()=>{n(!0);const u=await y.data.query(`
            SELECT 
                s.item_id,
                s.location_id,
                s.quantity as current_qty,
                s.min_stock,
                s.reorder_point,
                i.name as item_name,
                i.sku as item_sku,
                l.name as location_name
            FROM com_hubbi_inventory_stock s
            JOIN com_hubbi_inventory_items i ON s.item_id = i.id
            LEFT JOIN com_hubbi_inventory_locations l ON s.location_id = l.id
            WHERE s.quantity <= s.reorder_point OR s.quantity <= s.min_stock
            ORDER BY (s.min_stock - s.quantity) DESC
        `);if(u&&Array.isArray(u)){const g=u.map(m=>({...m,severity:m.current_qty<=m.min_stock?"critical":m.current_qty<=m.reorder_point?"warning":"ok"}));o(g)}s(new Date),n(!1)},[]);x.useEffect(()=>{l();const u=()=>{l()};return y.events.on("inventory:stock:increased",u),y.events.on("inventory:stock:decreased",u),()=>{y.events.off("inventory:stock:increased",u),y.events.off("inventory:stock:decreased",u)}},[l]);const d=e.filter(u=>u.severity==="critical").length,c=e.filter(u=>u.severity==="warning").length;return{alerts:e,criticalCount:d,warningCount:c,loading:t,lastCheck:r,refresh:l}},dt=({compact:e=!1})=>{const{alerts:o,criticalCount:t,warningCount:n,loading:r,lastCheck:s,refresh:l}=Fn(),d=e?o.slice(0,3):o;return i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[i.jsxs("div",{className:"p-4 border-b border-gray-100 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(nt,{size:20,className:"text-orange-500"}),i.jsx("h3",{className:"font-semibold text-gray-900",children:"Alertas de Stock"}),t>0&&i.jsx("span",{className:"bg-red-500 text-white text-xs px-2 py-0.5 rounded-full font-bold",children:t}),n>0&&i.jsx("span",{className:"bg-yellow-500 text-white text-xs px-2 py-0.5 rounded-full font-bold",children:n})]}),i.jsx("button",{onClick:l,disabled:r,className:"p-2 hover:bg-gray-100 rounded-full text-gray-500 disabled:opacity-50",children:i.jsx(hn,{size:16,className:r?"animate-spin":""})})]}),i.jsx("div",{className:`${e?"max-h-32":"max-h-64"} overflow-auto`,children:d.length===0?i.jsxs("div",{className:"p-8 text-center text-gray-400",children:[i.jsx(nt,{size:32,className:"mx-auto mb-2 opacity-30"}),i.jsx("p",{children:"No hay alertas de stock"})]}):i.jsx("div",{className:"divide-y divide-gray-100",children:d.map((c,u)=>i.jsxs("div",{className:`p-3 flex items-center gap-3 ${c.severity==="critical"?"bg-red-50":c.severity==="warning"?"bg-yellow-50":""}`,children:[i.jsx(te,{size:18,className:c.severity==="critical"?"text-red-500":"text-yellow-500"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"font-medium text-gray-900 truncate",children:c.item_name}),i.jsxs("div",{className:"text-xs text-gray-500",children:[c.location_name||"Sin ubicaciÃ³n"," â€¢ Stock: ",c.current_qty," / MÃ­nimo: ",c.min_stock]})]}),i.jsx("div",{className:`text-xs font-bold px-2 py-1 rounded ${c.severity==="critical"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:c.severity==="critical"?"CRÃTICO":"BAJO"})]},u))})}),s&&i.jsxs("div",{className:"p-2 border-t border-gray-100 text-xs text-gray-400 text-center",children:["Ãšltima verificaciÃ³n: ",s.toLocaleTimeString()]})]})};async function ct(e){const{itemId:o,locationId:t}=e;let n=`
    SELECT 
      s.item_id as itemId,
      s.location_id as locationId,
      s.quantity as totalStock,
      COALESCE((
        SELECT SUM(r.quantity) 
        FROM com_hubbi_inventory_reservations r 
        WHERE r.item_id = s.item_id 
          AND r.location_id = s.location_id 
          AND r.status = 'active'
      ), 0) as reservedStock,
      s.min_stock as minStock,
      s.reorder_point as reorderPoint
    FROM com_hubbi_inventory_stock s
    WHERE s.item_id = ?
  `;const r=[o];return t&&(n+=" AND s.location_id = ?",r.push(t)),(await y.db.query(n,r,{moduleId:"com.hubbi.inventory"})).map(l=>({itemId:l.itemId,locationId:l.locationId,totalStock:l.totalStock,reservedStock:l.reservedStock,availableStock:l.totalStock-l.reservedStock,minStock:l.minStock,reorderPoint:l.reorderPoint}))}async function qe(e){const o=await ct({itemId:e.itemId,locationId:e.locationId});if(o.length===0)return{available:!1,currentStock:0,requestedQuantity:e.quantity};const t=o[0];return{available:t.availableStock>=e.quantity,currentStock:t.availableStock,requestedQuantity:e.quantity}}async function Mn(e){let o=`
    SELECT 
      i.id as itemId,
      i.name as itemName,
      i.sku,
      s.location_id as locationId,
      s.quantity as currentStock,
      s.reorder_point as reorderPoint,
      (s.reorder_point - s.quantity) as deficit
    FROM com_hubbi_inventory_stock s
    JOIN com_hubbi_inventory_items i ON s.item_id = i.id
    WHERE s.quantity <= s.reorder_point
      AND i.is_active = TRUE
  `;const t=[];return e!=null&&e.locationId&&(o+=" AND s.location_id = ?",t.push(e.locationId)),o+=" ORDER BY deficit DESC",await y.db.query(o,t,{moduleId:"com.hubbi.inventory"})}async function An(e){var n;const o=await qe({itemId:e.itemId,locationId:e.locationId,quantity:e.quantity});if(!o.available)return{success:!1,error:`Stock insuficiente. Disponible: ${o.currentStock}, Solicitado: ${e.quantity}`};const t=crypto.randomUUID();return await y.db.execute(`
    INSERT INTO com_hubbi_inventory_reservations 
      (id, item_id, location_id, quantity, reference_type, reference_id, created_by, expires_at, status)
    VALUES (?, ?, ?, ?, ?, ?, ?, ?, 'active')
  `,[t,e.itemId,e.locationId,e.quantity,e.referenceType,e.referenceId,e.createdBy,e.expiresAt||null],{moduleId:"com.hubbi.inventory"}),ne("reservation:created",{reservationId:t,itemId:e.itemId,quantity:e.quantity,referenceType:e.referenceType,referenceId:e.referenceId}),(n=y.audit)==null||n.call(y,{action:"reservation_created",entity:"inventory_reservation",entityId:t,description:`Reserva de ${e.quantity} unidades para ${e.referenceType}:${e.referenceId}`}),{success:!0,reservationId:t}}async function Dn(e){const o=await y.db.query("SELECT * FROM com_hubbi_inventory_reservations WHERE id = ? AND status = 'active'",[e.reservationId],{moduleId:"com.hubbi.inventory"});if(o.length===0)return{success:!1,error:"Reserva no encontrada o ya consumida"};const t=o[0],n=crypto.randomUUID(),r=await y.db.query("SELECT weighted_average_cost FROM com_hubbi_inventory_items WHERE id = ?",[t.item_id],{moduleId:"com.hubbi.inventory"}),s=r.length>0?r[0].weighted_average_cost:0,l=t.quantity;return await y.db.execute(`
    INSERT INTO com_hubbi_inventory_movements 
      (id, item_id, location_id, type, reason, quantity, cost_at_moment, total_value, created_by)
    VALUES (?, ?, ?, 'OUT', 'internal_use', ?, ?, ?, ?)
  `,[n,t.item_id,t.location_id,l,s,l*s,e.consumedBy],{moduleId:"com.hubbi.inventory"}),await y.db.execute(`
    UPDATE com_hubbi_inventory_stock 
    SET quantity = quantity - ? 
    WHERE item_id = ? AND location_id = ?
  `,[l,t.item_id,t.location_id],{moduleId:"com.hubbi.inventory"}),await y.db.execute(`
    UPDATE com_hubbi_inventory_reservations SET status = 'consumed' WHERE id = ?
  `,[e.reservationId],{moduleId:"com.hubbi.inventory"}),ne("reservation:consumed",{reservationId:e.reservationId,movementId:n,itemId:t.item_id,quantity:l}),ne("stock:decreased",{itemId:t.item_id,locationId:t.location_id,quantity:l,reason:"internal_use",movementId:n}),{success:!0,movementId:n}}async function Pn(e){return await y.db.execute(`
    UPDATE com_hubbi_inventory_reservations SET status = 'cancelled' WHERE id = ?
  `,[e.reservationId],{moduleId:"com.hubbi.inventory"}),ne("reservation:cancelled",{reservationId:e.reservationId,reason:e.reason}),{success:!0}}async function Tn(e){var c;if(e.type==="OUT"&&e.reason!=="correction"){const u=await qe({itemId:e.itemId,locationId:e.locationId,quantity:e.quantity});if(!u.available)return{success:!1,error:`Stock insuficiente. Disponible: ${u.currentStock}, Solicitado: ${e.quantity}`}}let o=e.periodId;if(!o){const u=await He();o=u==null?void 0:u.id}if(o&&!await st(o))return{success:!1,error:`El perÃ­odo ${o} estÃ¡ cerrado o bloqueado. No se pueden registrar movimientos.`};if(e.subHubId){const u=y.permissions.has("inventory:edit_all_subhubs"),g=y.getContext(),m=e.subHubId===(g==null?void 0:g.subHubId),f=y.permissions.has("inventory:edit_own_subhub")&&m;if(!u&&!f)return{success:!1,error:"No tienes permiso para modificar inventario de esta sucursal."}}const t=crypto.randomUUID();let n=e.unitCost||0;if(!e.unitCost){const u=await y.db.query("SELECT weighted_average_cost FROM com_hubbi_inventory_items WHERE id = ? ",[e.itemId],{moduleId:"com.hubbi.inventory"});n=u.length>0?u[0].weighted_average_cost:0}await y.db.execute(`
    INSERT INTO com_hubbi_inventory_movements
                (id, item_id, location_id, type, reason, quantity, cost_at_moment, total_value,
                    document_type, document_number, document_uuid, created_by, sub_hub_id, period_id)
            VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
                `,[t,e.itemId,e.locationId,e.type,e.reason,e.quantity,n,e.quantity*n,e.documentType||null,e.documentNumber||null,e.documentUuid||null,e.createdBy,e.subHubId||null,o||null],{moduleId:"com.hubbi.inventory"});let r=e.quantity;e.type==="OUT"||e.type==="TRANSFER_OUT"?r=-e.quantity:e.type==="ADJUST"&&(r=e.quantity),await y.db.execute(`
    INSERT INTO com_hubbi_inventory_stock(item_id, location_id, quantity)
            VALUES(?, ?, ?)
    ON CONFLICT(item_id, location_id) DO UPDATE SET quantity = quantity + ?
                `,[e.itemId,e.locationId,r,r],{moduleId:"com.hubbi.inventory"}),(e.type==="IN"||e.type==="TRANSFER_IN")&&e.unitCost&&await $n(e.itemId,e.quantity,e.unitCost);const s=await y.db.query("SELECT quantity FROM com_hubbi_inventory_stock WHERE item_id = ? AND location_id = ? ",[e.itemId,e.locationId],{moduleId:"com.hubbi.inventory"}),l=s.length>0?s[0].quantity:0,d=e.type==="IN"||e.type==="TRANSFER_IN"||e.type==="ADJUST"&&e.quantity>0;return ne(d?"stock:increased":"stock:decreased",{itemId:e.itemId,locationId:e.locationId,quantity:e.quantity,reason:e.reason,movementId:t,newStock:l}),(c=y.audit)==null||c.call(y,{action:`stock_${e.type.toLowerCase()}`,entity:"inventory_movement",entityId:t,description:`${e.type==="IN"?"Entrada":"Salida"} de ${e.quantity} unidades - ${e.reason}`}),{success:!0,movementId:t,newStock:l}}async function $n(e,o,t){const n=await y.db.query("SELECT weighted_average_cost FROM com_hubbi_inventory_items WHERE id = ? ",[e],{moduleId:"com.hubbi.inventory"}),r=await y.db.query("SELECT SUM(quantity) as total FROM com_hubbi_inventory_stock WHERE item_id = ? ",[e],{moduleId:"com.hubbi.inventory"}),s=n.length>0?n[0].weighted_average_cost:0,l=r.length>0?r[0].total-o:0,d=l*s,c=o*t,u=l+o,g=u>0?(d+c)/u:t;await y.db.execute("UPDATE com_hubbi_inventory_items SET weighted_average_cost = ?, last_cost = ? WHERE id = ? ",[g,t,e],{moduleId:"com.hubbi.inventory"})}async function Vn(e){let o="SELECT * FROM com_hubbi_inventory_items WHERE ";const t=[];if(e.id)o+="id = ? ",t.push(e.id);else if(e.sku)o+="sku = ? ",t.push(e.sku);else return null;const n=await y.db.query(o,t,{moduleId:"com.hubbi.inventory"});return n.length>0?n[0]:null}async function Ln(e){let o=`
    SELECT * FROM com_hubbi_inventory_items 
    WHERE is_active = TRUE AND is_internal_use_only = FALSE
                `;const t=[];return e!=null&&e.categoryId&&(o+=" AND category_id = ? ",t.push(e.categoryId)),e!=null&&e.search&&(o+=" AND(name LIKE ? OR sku LIKE ?)",t.push(`% ${e.search}% `,` % ${e.search}% `)),o+=" ORDER BY name LIMIT ? ",t.push((e==null?void 0:e.limit)||100),await y.db.query(o,t,{moduleId:"com.hubbi.inventory"})}async function On(e){return await y.db.query(`
    SELECT
            k.child_item_id as componentId,
                i.name as componentName,
                i.sku as componentSku,
                k.quantity
    FROM com_hubbi_inventory_kits k
    JOIN com_hubbi_inventory_items i ON k.child_item_id = i.id
    WHERE k.parent_item_id = ?
                `,[e],{moduleId:"com.hubbi.inventory"})}function ne(e,o){window.dispatchEvent(new CustomEvent(`inventory:${e} `,{detail:{moduleId:"com.hubbi.inventory",timestamp:new Date().toISOString(),...o}}))}function Hn(){var o,t;if(!((t=(o=window.hubbi)==null?void 0:o.modules)!=null&&t.expose))return;const e="com.hubbi.inventory";window.hubbi.modules.expose("getStock",ct,e),window.hubbi.modules.expose("checkAvailability",qe,e),window.hubbi.modules.expose("getLowStockItems",Mn,e),window.hubbi.modules.expose("createReservation",An,e),window.hubbi.modules.expose("consumeReservation",Dn,e),window.hubbi.modules.expose("cancelReservation",Pn,e),window.hubbi.modules.expose("recordMovement",Tn,e),window.hubbi.modules.expose("getItem",Vn,e),window.hubbi.modules.expose("getSellableItems",Ln,e),window.hubbi.modules.expose("getKitComponents",On,e),window.hubbi.modules.expose("getCurrentPeriod",He,e),window.hubbi.modules.expose("isPeriodEditable",st,e)}const qn=()=>i.jsxs("div",{className:"inventory-settings p-4",children:[i.jsx("h2",{className:"text-lg font-bold",children:"ConfiguraciÃ³n de Inventario"}),i.jsx("p",{className:"text-gray-500",children:"PrÃ³ximamente: Ajustes de costos, prefijos y permisos."})]}),zn=()=>i.jsx(dt,{compact:!0}),Rn=()=>{var t,n,r;if(!(((r=(n=(t=window.hubbi)==null?void 0:t.permissions)==null?void 0:n.has)==null?void 0:r.call(n,"inventory:access"))??!0))return null;const o=()=>{var s,l;return(l=(s=window.hubbi)==null?void 0:s.navigate)==null?void 0:l.call(s,"/inventory")};return i.jsxs("button",{onClick:o,className:"w-full text-left px-3 py-2 hover:bg-gray-100 rounded-lg flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),i.jsx("span",{children:"Inventario"})]})},ut=async()=>{var e,o;(o=(e=window.hubbi)==null?void 0:e.widgets)!=null&&o.register&&(window.hubbi.widgets.register({slotName:"settings_tab",moduleId:"com.hubbi.inventory",component:qn,priority:10}),window.hubbi.widgets.register({slotName:"dashboard_widget",moduleId:"com.hubbi.inventory",component:zn,priority:20}),window.hubbi.widgets.register({slotName:"sidebar_item",moduleId:"com.hubbi.inventory",component:Rn,priority:30})),Hn(),Un()};async function Un(){var e,o,t;if(!(!((o=(e=window.hubbi)==null?void 0:e.db)!=null&&o.query)||!((t=window.hubbi)!=null&&t.sendNotification)))try{const n=await window.hubbi.db.query(`
      SELECT i.name, s.quantity, s.reorder_point, l.name as location_name
      FROM com_hubbi_inventory_stock s
      JOIN com_hubbi_inventory_items i ON s.item_id = i.id
      JOIN com_hubbi_inventory_locations l ON s.location_id = l.id
      WHERE s.quantity <= s.min_stock AND i.is_active = TRUE
      LIMIT 5
    `,[],{moduleId:"com.hubbi.inventory"});n.length>0&&await window.hubbi.sendNotification({title:"âš ï¸ Stock CrÃ­tico",message:`${n.length} productos requieren reabastecimiento urgente`,category:"inventory",severity:"warning",actionUrl:"/inventory/alerts"})}catch{}}const Gn=({activeTab:e,onTabChange:o})=>{const t=[{id:"overview",label:"Resumen",icon:i.jsx(gn,{size:20})},{id:"products",label:"Productos",icon:i.jsx(de,{size:20})},{id:"movements",label:"Movimientos",icon:i.jsx(Qe,{size:20})},{id:"transfers",label:"Transferencias",icon:i.jsx(Le,{size:20})},{id:"alerts",label:"Alertas",icon:i.jsx(te,{size:20})},{id:"audit",label:"AuditorÃ­a",icon:i.jsx(Ve,{size:20})},{id:"reports",label:"Reportes",icon:i.jsx(tt,{size:20})}];return i.jsxs("aside",{className:"w-64 bg-hubbi-card border-r border-hubbi-border flex flex-col h-full transition-colors duration-200",children:[i.jsx("div",{className:"p-6 border-b border-hubbi-border/50",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-hubbi-primary/10 rounded-lg text-hubbi-primary",children:i.jsx(un,{size:24})}),i.jsxs("div",{children:[i.jsx("h2",{className:"font-bold text-hubbi-text text-lg leading-tight",children:"Inventario"}),i.jsx("p",{className:"text-xs text-hubbi-text-dim",children:"GestiÃ³n WMS"})]})]})}),i.jsx("nav",{className:"flex-1 overflow-y-auto py-4 px-3 space-y-1",children:t.map(n=>i.jsxs("button",{onClick:()=>o(n.id),className:`
                            w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-all duration-200 group
                            ${e===n.id?"bg-hubbi-primary text-white shadow-md shadow-hubbi-primary/25":"text-hubbi-text-dim hover:bg-hubbi-bg hover:text-hubbi-text"}
                        `,children:[i.jsx("span",{className:e===n.id?"text-white":"text-hubbi-text-dim group-hover:text-hubbi-primary transition-colors",children:n.icon}),n.label]},n.id))}),i.jsx("div",{className:"p-4 border-t border-hubbi-border/50",children:i.jsxs("div",{className:"p-3 bg-hubbi-bg rounded-lg border border-hubbi-border/50",children:[i.jsx("h3",{className:"text-xs font-semibold text-hubbi-text uppercase tracking-wider mb-2",children:"Estado"}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-hubbi-text-dim",children:[i.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),"Sincronizado"]})]})})]})},jn=({onClose:e,onImport:o})=>{const[t,n]=x.useState(!1),[r,s]=x.useState(!0);x.useEffect(()=>{(async()=>{try{const g=(await y.db.query("SELECT count(*) as count FROM com_hubbi_inventory_items",[],{moduleId:"com.hubbi.inventory"}))[0].count,m=await y.settings.get("inventory_onboarding_dismissed");g===0&&!m&&n(!0)}catch(u){console.error("Error checking onboarding status:",u)}finally{s(!1)}})()},[]);const l=async()=>{n(!1),await y.settings.set("inventory_onboarding_dismissed",!0),e()},d=async()=>{n(!1),await y.settings.set("inventory_onboarding_dismissed",!0),o()};return r||!t?null:i.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:i.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-2xl w-full border border-gray-100 dark:border-gray-700 overflow-hidden animate-in fade-in zoom-in duration-300",children:i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-600 to-indigo-700 opacity-10"}),i.jsx("div",{className:"absolute -top-24 -right-24 w-64 h-64 bg-blue-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20"}),i.jsxs("div",{className:"relative p-8",children:[i.jsx("button",{onClick:l,className:"absolute top-4 right-4 p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors",children:i.jsx(Oe,{size:20})}),i.jsx("div",{className:"w-16 h-16 bg-blue-100 dark:bg-blue-900/30 rounded-2xl flex items-center justify-center mb-6 text-blue-600 dark:text-blue-400",children:i.jsx(de,{size:32,strokeWidth:1.5})}),i.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-3",children:"Bienvenido a Inventario"}),i.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 mb-8 max-w-md",children:"Tu espacio de trabajo estÃ¡ vacÃ­o. Vamos a configurar tus productos para empezar a gestionar tu stock."}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsxs("button",{onClick:d,className:"group relative overflow-hidden rounded-xl p-6 bg-white dark:bg-gray-700 border-2 border-blue-100 dark:border-blue-900/50 hover:border-blue-500 dark:hover:border-blue-400 transition-all text-left shadow-sm hover:shadow-md",children:[i.jsx("div",{className:"mb-4 w-10 h-10 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center text-green-600 dark:text-green-400 group-hover:scale-110 transition-transform",children:i.jsx(ce,{size:20})}),i.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white mb-1 flex items-center gap-2",children:["Importar Excel",i.jsx(et,{size:16,className:"opacity-0 group-hover:opacity-100 transition-opacity -translate-x-2 group-hover:translate-x-0"})]}),i.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Carga masiva de productos y stock inicial desde un archivo."})]}),i.jsxs("button",{onClick:l,className:"group relative overflow-hidden rounded-xl p-6 bg-gray-50 dark:bg-gray-700/50 border-2 border-transparent hover:border-gray-300 dark:hover:border-gray-600 transition-all text-left",children:[i.jsx("div",{className:"mb-4 w-10 h-10 bg-gray-200 dark:bg-gray-600/50 rounded-lg flex items-center justify-center text-gray-600 dark:text-gray-300 group-hover:scale-110 transition-transform",children:i.jsx(sn,{size:20})}),i.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-1",children:"Crear Manualmente"}),i.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"AÃ±ade productos uno por uno desde el formulario."})]})]})]})]})})})},Bn=()=>{const[e,o]=x.useState(!0),[t,n]=x.useState([]),[r,s]=x.useState([]),[l,d]=x.useState([]),[c,u]=x.useState(0);return x.useEffect(()=>{(async()=>{o(!0);try{const f=await y.db.query(`
                    SELECT 
                        m.item_id, 
                        i.name, 
                        i.sku, 
                        SUM(m.quantity) as total_quantity 
                    FROM com_hubbi_inventory_movements m
                    JOIN com_hubbi_inventory_items i ON m.item_id = i.id
                    WHERE m.type = 'OUT' AND m.reason = 'sale'
                    GROUP BY m.item_id, i.name, i.sku
                    ORDER BY total_quantity DESC
                `,[]);n(f.slice(0,5)),s([...f].reverse().slice(0,5));const a=await y.db.query(`
                    SELECT i.*, COALESCE(s.quantity, 0) as current_stock
                    FROM com_hubbi_inventory_items i
                    LEFT JOIN com_hubbi_inventory_stock s ON i.id = s.item_id
                    WHERE COALESCE(s.quantity, 0) <= i.min_stock
                    ORDER BY current_stock ASC
                    LIMIT 10
                `,[]);d(a);const h=await y.db.query(`
                    SELECT SUM(i.weighted_average_cost * s.quantity) as total_value
                    FROM com_hubbi_inventory_items i
                    JOIN com_hubbi_inventory_stock s ON i.id = s.item_id
                `,[]);u(h[0].total_value||0)}catch(m){console.error("Error fetching stats:",m),y.notify.error("Error al cargar estadÃ­sticas")}finally{o(!1)}})()},[]),e?i.jsxs("div",{className:"flex items-center justify-center h-full text-hubbi-text-dim animate-pulse",children:[i.jsx(tt,{size:48,className:"mb-4"}),i.jsx("p",{children:"Calculando mÃ©tricas..."})]}):i.jsxs("div",{className:"p-6 space-y-6 overflow-y-auto h-full text-hubbi-text",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"bg-hubbi-card p-4 rounded-xl border border-hubbi-border shadow-sm flex items-center gap-4",children:[i.jsx("div",{className:"p-3 bg-green-100 text-green-600 rounded-lg",children:i.jsx(it,{size:24})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-hubbi-text-dim",children:"Valor Total Inventario"}),i.jsxs("h3",{className:"text-2xl font-bold",children:["$",c.toLocaleString(void 0,{minimumFractionDigits:2})]})]})]}),i.jsxs("div",{className:"bg-hubbi-card p-4 rounded-xl border border-hubbi-border shadow-sm flex items-center gap-4",children:[i.jsx("div",{className:"p-3 bg-blue-100 text-blue-600 rounded-lg",children:i.jsx(vn,{size:24})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-hubbi-text-dim",children:"Productos MÃ¡s Vendidos"}),i.jsx("h3",{className:"text-2xl font-bold",children:t.length>0?t[0].name:"N/A"})]})]}),i.jsxs("div",{className:"bg-hubbi-card p-4 rounded-xl border border-hubbi-border shadow-sm flex items-center gap-4",children:[i.jsx("div",{className:"p-3 bg-red-100 text-red-600 rounded-lg",children:i.jsx(te,{size:24})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-hubbi-text-dim",children:"Alertas de Stock"}),i.jsxs("h3",{className:"text-2xl font-bold",children:[l.length," productos"]})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"bg-hubbi-card rounded-xl border border-hubbi-border shadow-sm overflow-hidden",children:[i.jsx("div",{className:"p-4 border-b border-hubbi-border bg-gray-50 dark:bg-gray-800/50",children:i.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[i.jsx(it,{size:18,className:"text-green-500"}),"MÃ¡s Vendidos"]})}),i.jsx("div",{className:"p-4",children:t.length===0?i.jsx("p",{className:"text-center text-hubbi-text-dim py-8",children:"No hay datos de ventas aÃºn."}):i.jsx("div",{className:"space-y-4",children:t.map((g,m)=>i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"w-6 h-6 flex items-center justify-center bg-gray-100 rounded-full text-xs font-bold text-gray-500",children:m+1}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium",children:g.name}),i.jsx("p",{className:"text-xs text-hubbi-text-dim",children:g.sku})]})]}),i.jsxs("span",{className:"font-mono font-bold text-hubbi-primary",children:[g.total_quantity," un."]})]},g.item_id))})})]}),i.jsxs("div",{className:"bg-hubbi-card rounded-xl border border-hubbi-border shadow-sm overflow-hidden",children:[i.jsx("div",{className:"p-4 border-b border-hubbi-border bg-gray-50 dark:bg-gray-800/50",children:i.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[i.jsx(te,{size:18,className:"text-red-500"}),"Stock CrÃ­tico"]})}),i.jsx("div",{className:"p-4",children:l.length===0?i.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-green-500 gap-2",children:[i.jsx(de,{size:32}),i.jsx("p",{className:"font-medium",children:"Todo en orden"})]}):i.jsx("div",{className:"space-y-3",children:l.map(g=>i.jsxs("div",{className:"flex items-center justify-between p-2 bg-red-50 dark:bg-red-900/10 rounded-lg border border-red-100 dark:border-red-900/20",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-pulse"}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-red-900 dark:text-red-200",children:g.name}),i.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400",children:["Min: ",g.min_stock," | Actual: ",g.current_stock]})]})]}),i.jsx("button",{className:"text-xs bg-white dark:bg-gray-800 border border-red-200 dark:border-red-800 text-red-600 dark:text-red-400 px-2 py-1 rounded hover:bg-red-50 transition-colors",children:"Reabastecer"})]},g.id))})})]}),i.jsxs("div",{className:"bg-hubbi-card rounded-xl border border-hubbi-border shadow-sm overflow-hidden",children:[i.jsx("div",{className:"p-4 border-b border-hubbi-border bg-gray-50 dark:bg-gray-800/50",children:i.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[i.jsx(xn,{size:18,className:"text-orange-500"}),"Menos Vendidos (RotaciÃ³n Lenta)"]})}),i.jsx("div",{className:"p-4",children:r.length===0?i.jsx("p",{className:"text-center text-hubbi-text-dim py-8",children:"No hay datos suficientes."}):i.jsx("div",{className:"space-y-4",children:r.map((g,m)=>i.jsxs("div",{className:"flex items-center justify-between opacity-75",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"w-6 h-6 flex items-center justify-center bg-gray-100 rounded-full text-xs font-bold text-gray-500",children:m+1}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium",children:g.name}),i.jsx("p",{className:"text-xs text-hubbi-text-dim",children:g.sku})]})]}),i.jsxs("span",{className:"font-mono text-gray-500",children:[g.total_quantity," un."]})]},g.item_id))})})]})]})]})},gt=()=>{const[e,o]=x.useState("overview"),[t,n]=x.useState(!1),r=()=>{switch(e){case"overview":return i.jsx(Bn,{});case"products":return i.jsx(at,{});case"movements":return i.jsx(En,{});case"transfers":return i.jsx(Nn,{});case"alerts":return i.jsx(dt,{});case"audit":return i.jsx(kn,{});case"reports":return i.jsx("div",{className:"flex flex-col gap-6",children:i.jsxs("div",{className:"bg-hubbi-card border border-hubbi-border rounded-xl p-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-hubbi-text mb-4",children:"Exportar Datos"}),i.jsx("p",{className:"text-hubbi-text-dim mb-6",children:"Descarga reportes de inventario en formato Excel."}),i.jsx("button",{className:"px-4 py-2 bg-hubbi-primary text-white rounded-lg opacity-50 cursor-not-allowed",children:"Reportes avanzados (WIP)"})]})});default:return i.jsx(at,{})}};return i.jsxs("div",{className:"flex h-screen w-full bg-hubbi-bg overflow-hidden text-hubbi-text",children:[i.jsx(Gn,{activeTab:e,onTabChange:o}),i.jsx("main",{className:"flex-1 flex flex-col min-w-0 overflow-hidden relative",children:i.jsx("div",{className:"flex-1 overflow-auto p-6 scrollbar-thin scrollbar-thumb-hubbi-border scrollbar-track-transparent",children:i.jsx("div",{className:"max-w-7xl mx-auto h-full flex flex-col",children:r()})})}),i.jsx(jn,{onClose:()=>{},onImport:()=>n(!0)}),t&&i.jsx(lt,{onClose:()=>n(!1),onSuccess:s=>{console.log(`Imported ${s} items`)}})]})};function Wn(){const e="com.hubbi.inventory";typeof window<"u"&&window.hubbi&&typeof window.hubbi.register=="function"?(window.hubbi.register(e,gt),typeof ut=="function"&&ut().catch(o=>{console.error("[Inventory Module] Activation error:",o)}),console.log(`[PluginEntry] Plugin '${e}' registered successfully`)):console.error("[PluginEntry] window.hubbi.register not found. Cannot register plugin.")}return Wn(),gt});
